var Jn=Object.defineProperty,Yn=Object.defineProperties;var Xn=Object.getOwnPropertyDescriptors;var Ge=Object.getOwnPropertySymbols;var Zn=Object.prototype.hasOwnProperty,Qn=Object.prototype.propertyIsEnumerable;var He=(e,t,r)=>t in e?Jn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Z=(e,t)=>{for(var r in t||(t={}))Zn.call(t,r)&&He(e,r,t[r]);if(Ge)for(var r of Ge(t))Qn.call(t,r)&&He(e,r,t[r]);return e},Q=(e,t)=>Yn(e,Xn(t));const to=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}};to();var V=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},G={},Ur={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=t;function t(r){var n,o=r.Symbol;if(typeof o=="function")if(o.observable)n=o.observable;else{n=o.for("https://github.com/benlesh/symbol-observable");try{o.observable=n}catch{}}else n="@@observable";return n}})(Ur);var eo=Ur,ze=Object.prototype.toString,Wr=function(t){var r=ze.call(t),n=r==="[object Arguments]";return n||(n=r!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&ze.call(t.callee)==="[object Function]"),n},qr;if(!Object.keys){var Wt=Object.prototype.hasOwnProperty,Ke=Object.prototype.toString,ro=Wr,Ve=Object.prototype.propertyIsEnumerable,no=!Ve.call({toString:null},"toString"),oo=Ve.call(function(){},"prototype"),qt=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],ue=function(e){var t=e.constructor;return t&&t.prototype===e},io={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},ao=function(){if(typeof window=="undefined")return!1;for(var e in window)try{if(!io["$"+e]&&Wt.call(window,e)&&window[e]!==null&&typeof window[e]=="object")try{ue(window[e])}catch{return!0}}catch{return!0}return!1}(),so=function(e){if(typeof window=="undefined"||!ao)return ue(e);try{return ue(e)}catch{return!1}};qr=function(t){var r=t!==null&&typeof t=="object",n=Ke.call(t)==="[object Function]",o=ro(t),i=r&&Ke.call(t)==="[object String]",a=[];if(!r&&!n&&!o)throw new TypeError("Object.keys called on a non-object");var s=oo&&n;if(i&&t.length>0&&!Wt.call(t,0))for(var u=0;u<t.length;++u)a.push(String(u));if(o&&t.length>0)for(var c=0;c<t.length;++c)a.push(String(c));else for(var p in t)!(s&&p==="prototype")&&Wt.call(t,p)&&a.push(String(p));if(no)for(var f=so(t),h=0;h<qt.length;++h)!(f&&qt[h]==="constructor")&&Wt.call(t,qt[h])&&a.push(qt[h]);return a}}var uo=qr,co=Array.prototype.slice,fo=Wr,Je=Object.keys,Kt=Je?function(t){return Je(t)}:uo,Ye=Object.keys;Kt.shim=function(){if(Object.keys){var t=function(){var r=Object.keys(arguments);return r&&r.length===arguments.length}(1,2);t||(Object.keys=function(n){return fo(n)?Ye(co.call(n)):Ye(n)})}else Object.keys=Kt;return Object.keys||Kt};var lo=Kt,po=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var o=42;t[r]=o;for(r in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var i=Object.getOwnPropertySymbols(t);if(i.length!==1||i[0]!==r||!Object.prototype.propertyIsEnumerable.call(t,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(t,r);if(a.value!==o||a.enumerable!==!0)return!1}return!0},Xe=typeof Symbol!="undefined"&&Symbol,ho=po,yo=function(){return typeof Xe!="function"||typeof Symbol!="function"||typeof Xe("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:ho()},vo="Function.prototype.bind called on incompatible ",ce=Array.prototype.slice,mo=Object.prototype.toString,go="[object Function]",bo=function(t){var r=this;if(typeof r!="function"||mo.call(r)!==go)throw new TypeError(vo+r);for(var n=ce.call(arguments,1),o,i=function(){if(this instanceof o){var p=r.apply(this,n.concat(ce.call(arguments)));return Object(p)===p?p:this}else return r.apply(t,n.concat(ce.call(arguments)))},a=Math.max(0,r.length-n.length),s=[],u=0;u<a;u++)s.push("$"+u);if(o=Function("binder","return function ("+s.join(",")+"){ return binder.apply(this,arguments); }")(i),r.prototype){var c=function(){};c.prototype=r.prototype,o.prototype=new c,c.prototype=null}return o},_o=bo,Gr=Function.prototype.bind||_o,wo=Gr,So=wo.call(Function.call,Object.prototype.hasOwnProperty),C,Ft=SyntaxError,Hr=Function,Et=TypeError,fe=function(e){try{return Hr('"use strict"; return ('+e+").constructor;")()}catch{}},mt=Object.getOwnPropertyDescriptor;if(mt)try{mt({},"")}catch{mt=null}var le=function(){throw new Et},Oo=mt?function(){try{return arguments.callee,le}catch{try{return mt(arguments,"callee").get}catch{return le}}}():le,bt=yo(),ft=Object.getPrototypeOf||function(e){return e.__proto__},St={},Ao=typeof Uint8Array=="undefined"?C:ft(Uint8Array),$t={"%AggregateError%":typeof AggregateError=="undefined"?C:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?C:ArrayBuffer,"%ArrayIteratorPrototype%":bt?ft([][Symbol.iterator]()):C,"%AsyncFromSyncIteratorPrototype%":C,"%AsyncFunction%":St,"%AsyncGenerator%":St,"%AsyncGeneratorFunction%":St,"%AsyncIteratorPrototype%":St,"%Atomics%":typeof Atomics=="undefined"?C:Atomics,"%BigInt%":typeof BigInt=="undefined"?C:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?C:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array=="undefined"?C:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?C:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?C:FinalizationRegistry,"%Function%":Hr,"%GeneratorFunction%":St,"%Int8Array%":typeof Int8Array=="undefined"?C:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?C:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?C:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":bt?ft(ft([][Symbol.iterator]())):C,"%JSON%":typeof JSON=="object"?JSON:C,"%Map%":typeof Map=="undefined"?C:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!bt?C:ft(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?C:Promise,"%Proxy%":typeof Proxy=="undefined"?C:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect=="undefined"?C:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?C:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!bt?C:ft(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?C:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":bt?ft(""[Symbol.iterator]()):C,"%Symbol%":bt?Symbol:C,"%SyntaxError%":Ft,"%ThrowTypeError%":Oo,"%TypedArray%":Ao,"%TypeError%":Et,"%Uint8Array%":typeof Uint8Array=="undefined"?C:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?C:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?C:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?C:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap=="undefined"?C:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?C:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?C:WeakSet},Eo=function e(t){var r;if(t==="%AsyncFunction%")r=fe("async function () {}");else if(t==="%GeneratorFunction%")r=fe("function* () {}");else if(t==="%AsyncGeneratorFunction%")r=fe("async function* () {}");else if(t==="%AsyncGenerator%"){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(t==="%AsyncIteratorPrototype%"){var o=e("%AsyncGenerator%");o&&(r=ft(o.prototype))}return $t[t]=r,r},Ze={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},oe=Gr,Zt=So,$o=oe.call(Function.call,Array.prototype.concat),No=oe.call(Function.apply,Array.prototype.splice),Qe=oe.call(Function.call,String.prototype.replace),Qt=oe.call(Function.call,String.prototype.slice),Po=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Co=/\\(\\)?/g,Io=function(t){var r=Qt(t,0,1),n=Qt(t,-1);if(r==="%"&&n!=="%")throw new Ft("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new Ft("invalid intrinsic syntax, expected opening `%`");var o=[];return Qe(t,Po,function(i,a,s,u){o[o.length]=s?Qe(u,Co,"$1"):a||i}),o},To=function(t,r){var n=t,o;if(Zt(Ze,n)&&(o=Ze[n],n="%"+o[0]+"%"),Zt($t,n)){var i=$t[n];if(i===St&&(i=Eo(n)),typeof i=="undefined"&&!r)throw new Et("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:o,name:n,value:i}}throw new Ft("intrinsic "+t+" does not exist!")},Do=function(t,r){if(typeof t!="string"||t.length===0)throw new Et("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new Et('"allowMissing" argument must be a boolean');var n=Io(t),o=n.length>0?n[0]:"",i=To("%"+o+"%",r),a=i.name,s=i.value,u=!1,c=i.alias;c&&(o=c[0],No(n,$o([0,1],c)));for(var p=1,f=!0;p<n.length;p+=1){var h=n[p],b=Qt(h,0,1),l=Qt(h,-1);if((b==='"'||b==="'"||b==="`"||l==='"'||l==="'"||l==="`")&&b!==l)throw new Ft("property names with quotes must have matching quotes");if((h==="constructor"||!f)&&(u=!0),o+="."+h,a="%"+o+"%",Zt($t,a))s=$t[a];else if(s!=null){if(!(h in s)){if(!r)throw new Et("base intrinsic for "+t+" exists, but the property is not available.");return}if(mt&&p+1>=n.length){var d=mt(s,h);f=!!d,f&&"get"in d&&!("originalValue"in d.get)?s=d.get:s=s[h]}else f=Zt(s,h),s=s[h];f&&!u&&($t[a]=s)}}return s},ko=Do,_e=ko("%Object.defineProperty%",!0),we=function(){if(_e)try{return _e({},"a",{value:1}),!0}catch{return!1}return!1};we.hasArrayLengthDefineBug=function(){if(!we())return null;try{return _e([],"length",{value:1}).length!==1}catch{return!0}};var xo=we,Mo=lo,jo=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",Lo=Object.prototype.toString,Fo=Array.prototype.concat,zr=Object.defineProperty,Ro=function(e){return typeof e=="function"&&Lo.call(e)==="[object Function]"},Bo=xo(),Kr=zr&&Bo,Uo=function(e,t,r,n){t in e&&(!Ro(n)||!n())||(Kr?zr(e,t,{configurable:!0,enumerable:!1,value:r,writable:!0}):e[t]=r)},Vr=function(e,t){var r=arguments.length>2?arguments[2]:{},n=Mo(t);jo&&(n=Fo.call(n,Object.getOwnPropertySymbols(t)));for(var o=0;o<n.length;o+=1)Uo(e,n[o],t[n[o]],r[n[o]])};Vr.supportsDescriptors=!!Kr;var Jr=Vr,jt={exports:{}};typeof self!="undefined"?jt.exports=self:typeof window!="undefined"?jt.exports=window:jt.exports=Function("return this")();var Wo=jt.exports,Yr=function(){return typeof V!="object"||!V||V.Math!==Math||V.Array!==Array?Wo:V},qo=Jr,Go=Yr,Ho=function(){var t=Go();if(qo.supportsDescriptors){var r=Object.getOwnPropertyDescriptor(t,"globalThis");(!r||r.configurable&&(r.enumerable||!r.writable||globalThis!==t))&&Object.defineProperty(t,"globalThis",{configurable:!0,enumerable:!1,value:t,writable:!0})}else(typeof globalThis!="object"||globalThis!==t)&&(t.globalThis=t);return t},zo=Jr,Ko=jt.exports,Xr=Yr,Vo=Ho,Jo=Xr(),Zr=function(){return Jo};zo(Zr,{getPolyfill:Xr,implementation:Ko,shim:Vo});var Yo=Zr,Xo=V&&V.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(G,"__esModule",{value:!0});G.NO_IL=xe=G.NO=G.MemoryStream=et=G.Stream=void 0;var Zo=eo,Qo=Yo,Gt=Zo.default(Qo.getPolyfill()),v={},xe=G.NO=v;function q(){}function Vt(e){for(var t=e.length,r=Array(t),n=0;n<t;++n)r[n]=e[n];return r}function ti(e,t){return function(n){return e(n)&&t(n)}}function Me(e,t,r){try{return e.f(t)}catch(n){return r._e(n),v}}var vt={_n:q,_e:q,_c:q};G.NO_IL=vt;function tr(e){e._start=function(r){r.next=r._n,r.error=r._e,r.complete=r._c,this.start(r)},e._stop=e.stop}var ei=function(){function e(t,r){this._stream=t,this._listener=r}return e.prototype.unsubscribe=function(){this._stream._remove(this._listener)},e}(),ri=function(){function e(t){this._listener=t}return e.prototype.next=function(t){this._listener._n(t)},e.prototype.error=function(t){this._listener._e(t)},e.prototype.complete=function(){this._listener._c()},e}(),ni=function(){function e(t){this.type="fromObservable",this.ins=t,this.active=!1}return e.prototype._start=function(t){this.out=t,this.active=!0,this._sub=this.ins.subscribe(new ri(t)),this.active||this._sub.unsubscribe()},e.prototype._stop=function(){this._sub&&this._sub.unsubscribe(),this.active=!1},e}(),oi=function(){function e(t){this.type="merge",this.insArr=t,this.out=v,this.ac=0}return e.prototype._start=function(t){this.out=t;var r=this.insArr,n=r.length;this.ac=n;for(var o=0;o<n;o++)r[o]._add(this)},e.prototype._stop=function(){for(var t=this.insArr,r=t.length,n=0;n<r;n++)t[n]._remove(this);this.out=v},e.prototype._n=function(t){var r=this.out;r!==v&&r._n(t)},e.prototype._e=function(t){var r=this.out;r!==v&&r._e(t)},e.prototype._c=function(){if(--this.ac<=0){var t=this.out;if(t===v)return;t._c()}},e}(),ii=function(){function e(t,r,n){this.i=t,this.out=r,this.p=n,n.ils.push(this)}return e.prototype._n=function(t){var r=this.p,n=this.out;if(n!==v&&r.up(t,this.i)){var o=Vt(r.vals);n._n(o)}},e.prototype._e=function(t){var r=this.out;r!==v&&r._e(t)},e.prototype._c=function(){var t=this.p;t.out!==v&&--t.Nc===0&&t.out._c()},e}(),ai=function(){function e(t){this.type="combine",this.insArr=t,this.out=v,this.ils=[],this.Nc=this.Nn=0,this.vals=[]}return e.prototype.up=function(t,r){var n=this.vals[r],o=this.Nn?n===v?--this.Nn:this.Nn:0;return this.vals[r]=t,o===0},e.prototype._start=function(t){this.out=t;var r=this.insArr,n=this.Nc=this.Nn=r.length,o=this.vals=new Array(n);if(n===0)t._n([]),t._c();else for(var i=0;i<n;i++)o[i]=v,r[i]._add(new ii(i,t,this))},e.prototype._stop=function(){for(var t=this.insArr,r=t.length,n=this.ils,o=0;o<r;o++)t[o]._remove(n[o]);this.out=v,this.ils=[],this.vals=[]},e}(),si=function(){function e(t){this.type="fromArray",this.a=t}return e.prototype._start=function(t){for(var r=this.a,n=0,o=r.length;n<o;n++)t._n(r[n]);t._c()},e.prototype._stop=function(){},e}(),ui=function(){function e(t){this.type="fromPromise",this.on=!1,this.p=t}return e.prototype._start=function(t){var r=this;this.on=!0,this.p.then(function(n){r.on&&(t._n(n),t._c())},function(n){t._e(n)}).then(q,function(n){setTimeout(function(){throw n})})},e.prototype._stop=function(){this.on=!1},e}(),ci=function(){function e(t){this.type="periodic",this.period=t,this.intervalID=-1,this.i=0}return e.prototype._start=function(t){var r=this;function n(){t._n(r.i++)}this.intervalID=setInterval(n,this.period)},e.prototype._stop=function(){this.intervalID!==-1&&clearInterval(this.intervalID),this.intervalID=-1,this.i=0},e}(),fi=function(){function e(t,r){this.type="debug",this.ins=t,this.out=v,this.s=q,this.l="",typeof r=="string"?this.l=r:typeof r=="function"&&(this.s=r)}return e.prototype._start=function(t){this.out=t,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=v},e.prototype._n=function(t){var r=this.out;if(r!==v){var n=this.s,o=this.l;if(n!==q)try{n(t)}catch(i){r._e(i)}else o?console.log(o+":",t):console.log(t);r._n(t)}},e.prototype._e=function(t){var r=this.out;r!==v&&r._e(t)},e.prototype._c=function(){var t=this.out;t!==v&&t._c()},e}(),li=function(){function e(t,r){this.type="drop",this.ins=r,this.out=v,this.max=t,this.dropped=0}return e.prototype._start=function(t){this.out=t,this.dropped=0,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=v},e.prototype._n=function(t){var r=this.out;r!==v&&this.dropped++>=this.max&&r._n(t)},e.prototype._e=function(t){var r=this.out;r!==v&&r._e(t)},e.prototype._c=function(){var t=this.out;t!==v&&t._c()},e}(),pi=function(){function e(t,r){this.out=t,this.op=r}return e.prototype._n=function(){this.op.end()},e.prototype._e=function(t){this.out._e(t)},e.prototype._c=function(){this.op.end()},e}(),di=function(){function e(t,r){this.type="endWhen",this.ins=r,this.out=v,this.o=t,this.oil=vt}return e.prototype._start=function(t){this.out=t,this.o._add(this.oil=new pi(t,this)),this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.o._remove(this.oil),this.out=v,this.oil=vt},e.prototype.end=function(){var t=this.out;t!==v&&t._c()},e.prototype._n=function(t){var r=this.out;r!==v&&r._n(t)},e.prototype._e=function(t){var r=this.out;r!==v&&r._e(t)},e.prototype._c=function(){this.end()},e}(),pe=function(){function e(t,r){this.type="filter",this.ins=r,this.out=v,this.f=t}return e.prototype._start=function(t){this.out=t,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=v},e.prototype._n=function(t){var r=this.out;if(r!==v){var n=Me(this,t,r);n===v||!n||r._n(t)}},e.prototype._e=function(t){var r=this.out;r!==v&&r._e(t)},e.prototype._c=function(){var t=this.out;t!==v&&t._c()},e}(),hi=function(){function e(t,r){this.out=t,this.op=r}return e.prototype._n=function(t){this.out._n(t)},e.prototype._e=function(t){this.out._e(t)},e.prototype._c=function(){this.op.inner=v,this.op.less()},e}(),yi=function(){function e(t){this.type="flatten",this.ins=t,this.out=v,this.open=!0,this.inner=v,this.il=vt}return e.prototype._start=function(t){this.out=t,this.open=!0,this.inner=v,this.il=vt,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.inner!==v&&this.inner._remove(this.il),this.out=v,this.open=!0,this.inner=v,this.il=vt},e.prototype.less=function(){var t=this.out;t!==v&&!this.open&&this.inner===v&&t._c()},e.prototype._n=function(t){var r=this.out;if(r!==v){var n=this,o=n.inner,i=n.il;o!==v&&i!==vt&&o._remove(i),(this.inner=t)._add(this.il=new hi(r,this))}},e.prototype._e=function(t){var r=this.out;r!==v&&r._e(t)},e.prototype._c=function(){this.open=!1,this.less()},e}(),vi=function(){function e(t,r,n){var o=this;this.type="fold",this.ins=n,this.out=v,this.f=function(i){return t(o.acc,i)},this.acc=this.seed=r}return e.prototype._start=function(t){this.out=t,this.acc=this.seed,t._n(this.acc),this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=v,this.acc=this.seed},e.prototype._n=function(t){var r=this.out;if(r!==v){var n=Me(this,t,r);n!==v&&r._n(this.acc=n)}},e.prototype._e=function(t){var r=this.out;r!==v&&r._e(t)},e.prototype._c=function(){var t=this.out;t!==v&&t._c()},e}(),mi=function(){function e(t){this.type="last",this.ins=t,this.out=v,this.has=!1,this.val=v}return e.prototype._start=function(t){this.out=t,this.has=!1,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=v,this.val=v},e.prototype._n=function(t){this.has=!0,this.val=t},e.prototype._e=function(t){var r=this.out;r!==v&&r._e(t)},e.prototype._c=function(){var t=this.out;t!==v&&(this.has?(t._n(this.val),t._c()):t._e(new Error("last() failed because input stream completed")))},e}(),gi=function(){function e(t,r){this.type="map",this.ins=r,this.out=v,this.f=t}return e.prototype._start=function(t){this.out=t,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=v},e.prototype._n=function(t){var r=this.out;if(r!==v){var n=Me(this,t,r);n!==v&&r._n(n)}},e.prototype._e=function(t){var r=this.out;r!==v&&r._e(t)},e.prototype._c=function(){var t=this.out;t!==v&&t._c()},e}(),bi=function(){function e(t){this.type="remember",this.ins=t,this.out=v}return e.prototype._start=function(t){this.out=t,this.ins._add(t)},e.prototype._stop=function(){this.ins._remove(this.out),this.out=v},e}(),_i=function(){function e(t,r){this.type="replaceError",this.ins=r,this.out=v,this.f=t}return e.prototype._start=function(t){this.out=t,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=v},e.prototype._n=function(t){var r=this.out;r!==v&&r._n(t)},e.prototype._e=function(t){var r=this.out;if(r!==v)try{this.ins._remove(this),(this.ins=this.f(t))._add(this)}catch(n){r._e(n)}},e.prototype._c=function(){var t=this.out;t!==v&&t._c()},e}(),wi=function(){function e(t,r){this.type="startWith",this.ins=t,this.out=v,this.val=r}return e.prototype._start=function(t){this.out=t,this.out._n(this.val),this.ins._add(t)},e.prototype._stop=function(){this.ins._remove(this.out),this.out=v},e}(),Si=function(){function e(t,r){this.type="take",this.ins=r,this.out=v,this.max=t,this.taken=0}return e.prototype._start=function(t){this.out=t,this.taken=0,this.max<=0?t._c():this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=v},e.prototype._n=function(t){var r=this.out;if(r!==v){var n=++this.taken;n<this.max?r._n(t):n===this.max&&(r._n(t),r._c())}},e.prototype._e=function(t){var r=this.out;r!==v&&r._e(t)},e.prototype._c=function(){var t=this.out;t!==v&&t._c()},e}(),je=function(){function e(t){this._prod=t||v,this._ils=[],this._stopID=v,this._dl=v,this._d=!1,this._target=null,this._err=v}return e.prototype._n=function(t){var r=this._ils,n=r.length;if(this._d&&this._dl._n(t),n==1)r[0]._n(t);else{if(n==0)return;for(var o=Vt(r),i=0;i<n;i++)o[i]._n(t)}},e.prototype._e=function(t){if(this._err===v){this._err=t;var r=this._ils,n=r.length;if(this._x(),this._d&&this._dl._e(t),n==1)r[0]._e(t);else{if(n==0)return;for(var o=Vt(r),i=0;i<n;i++)o[i]._e(t)}if(!this._d&&n==0)throw this._err}},e.prototype._c=function(){var t=this._ils,r=t.length;if(this._x(),this._d&&this._dl._c(),r==1)t[0]._c();else{if(r==0)return;for(var n=Vt(t),o=0;o<r;o++)n[o]._c()}},e.prototype._x=function(){this._ils.length!==0&&(this._prod!==v&&this._prod._stop(),this._err=v,this._ils=[])},e.prototype._stopNow=function(){this._prod._stop(),this._err=v,this._stopID=v},e.prototype._add=function(t){var r=this._target;if(r)return r._add(t);var n=this._ils;if(n.push(t),!(n.length>1))if(this._stopID!==v)clearTimeout(this._stopID),this._stopID=v;else{var o=this._prod;o!==v&&o._start(this)}},e.prototype._remove=function(t){var r=this,n=this._target;if(n)return n._remove(t);var o=this._ils,i=o.indexOf(t);i>-1&&(o.splice(i,1),this._prod!==v&&o.length<=0?(this._err=v,this._stopID=setTimeout(function(){return r._stopNow()})):o.length===1&&this._pruneCycles())},e.prototype._pruneCycles=function(){this._hasNoSinks(this,[])&&this._remove(this._ils[0])},e.prototype._hasNoSinks=function(t,r){if(r.indexOf(t)!==-1)return!0;if(t.out===this)return!0;if(t.out&&t.out!==v)return this._hasNoSinks(t.out,r.concat(t));if(t._ils){for(var n=0,o=t._ils.length;n<o;n++)if(!this._hasNoSinks(t._ils[n],r.concat(t)))return!1;return!0}else return!1},e.prototype.ctor=function(){return this instanceof st?st:e},e.prototype.addListener=function(t){t._n=t.next||q,t._e=t.error||q,t._c=t.complete||q,this._add(t)},e.prototype.removeListener=function(t){this._remove(t)},e.prototype.subscribe=function(t){return this.addListener(t),new ei(this,t)},e.prototype[Gt]=function(){return this},e.create=function(t){if(t){if(typeof t.start!="function"||typeof t.stop!="function")throw new Error("producer requires both start and stop functions");tr(t)}return new e(t)},e.createWithMemory=function(t){return t&&tr(t),new st(t)},e.never=function(){return new e({_start:q,_stop:q})},e.empty=function(){return new e({_start:function(t){t._c()},_stop:q})},e.throw=function(t){return new e({_start:function(r){r._e(t)},_stop:q})},e.from=function(t){if(typeof t[Gt]=="function")return e.fromObservable(t);if(typeof t.then=="function")return e.fromPromise(t);if(Array.isArray(t))return e.fromArray(t);throw new TypeError("Type of input to from() must be an Array, Promise, or Observable")},e.of=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.fromArray(t)},e.fromArray=function(t){return new e(new si(t))},e.fromPromise=function(t){return new e(new ui(t))},e.fromObservable=function(t){if(t.endWhen!==void 0)return t;var r=typeof t[Gt]=="function"?t[Gt]():t;return new e(new ni(r))},e.periodic=function(t){return new e(new ci(t))},e.prototype._map=function(t){return new(this.ctor())(new gi(t,this))},e.prototype.map=function(t){return this._map(t)},e.prototype.mapTo=function(t){var r=this.map(function(){return t}),n=r._prod;return n.type="mapTo",r},e.prototype.filter=function(t){var r=this._prod;return r instanceof pe?new e(new pe(ti(r.f,t),r.ins)):new e(new pe(t,this))},e.prototype.take=function(t){return new(this.ctor())(new Si(t,this))},e.prototype.drop=function(t){return new e(new li(t,this))},e.prototype.last=function(){return new e(new mi(this))},e.prototype.startWith=function(t){return new st(new wi(this,t))},e.prototype.endWhen=function(t){return new(this.ctor())(new di(t,this))},e.prototype.fold=function(t,r){return new st(new vi(t,r,this))},e.prototype.replaceError=function(t){return new(this.ctor())(new _i(t,this))},e.prototype.flatten=function(){return new e(new yi(this))},e.prototype.compose=function(t){return t(this)},e.prototype.remember=function(){return new st(new bi(this))},e.prototype.debug=function(t){return new(this.ctor())(new fi(this,t))},e.prototype.imitate=function(t){if(t instanceof st)throw new Error("A MemoryStream was given to imitate(), but it only supports a Stream. Read more about this restriction here: https://github.com/staltz/xstream#faq");this._target=t;for(var r=this._ils,n=r.length,o=0;o<n;o++)t._add(r[o]);this._ils=[]},e.prototype.shamefullySendNext=function(t){this._n(t)},e.prototype.shamefullySendError=function(t){this._e(t)},e.prototype.shamefullySendComplete=function(){this._c()},e.prototype.setDebugListener=function(t){t?(this._d=!0,t._n=t.next||q,t._e=t.error||q,t._c=t.complete||q,this._dl=t):(this._d=!1,this._dl=v)},e.merge=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return new e(new oi(r))},e.combine=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return new e(new ai(r))},e}(),et=G.Stream=je,st=function(e){Xo(t,e);function t(r){var n=e.call(this,r)||this;return n._has=!1,n}return t.prototype._n=function(r){this._v=r,this._has=!0,e.prototype._n.call(this,r)},t.prototype._add=function(r){var n=this._target;if(n)return n._add(r);var o=this._ils;if(o.push(r),o.length>1){this._has&&r._n(this._v);return}if(this._stopID!==v)this._has&&r._n(this._v),clearTimeout(this._stopID),this._stopID=v;else if(this._has)r._n(this._v);else{var i=this._prod;i!==v&&i._start(this)}},t.prototype._stopNow=function(){this._has=!1,e.prototype._stopNow.call(this)},t.prototype._x=function(){this._has=!1,e.prototype._x.call(this)},t.prototype.map=function(r){return this._map(r)},t.prototype.mapTo=function(r){return e.prototype.mapTo.call(this,r)},t.prototype.take=function(r){return e.prototype.take.call(this,r)},t.prototype.endWhen=function(r){return e.prototype.endWhen.call(this,r)},t.prototype.replaceError=function(r){return e.prototype.replaceError.call(this,r)},t.prototype.remember=function(){return this},t.prototype.debug=function(r){return e.prototype.debug.call(this,r)},t}(je);G.MemoryStream=st;var Oi=je,S=G.default=Oi,Le={};Object.defineProperty(Le,"__esModule",{value:!0});function Qr(){var e;return typeof window!="undefined"?e=window:typeof V!="undefined"?e=V:e=this,e.Cyclejs=e.Cyclejs||{},e=e.Cyclejs,e.adaptStream=e.adaptStream||function(t){return t},e}function Ai(e){Qr().adaptStream=e}Le.setAdapt=Ai;function Ei(e){return Qr().adaptStream(e)}var z=Le.adapt=Ei;function $i(e,t){if(typeof e!="function")throw new Error("First argument given to isolate() must be a 'dataflowComponent' function");if(t===null)throw new Error("Second argument given to isolate() must not be null")}function Ni(e,t,r){var n={};return Object.keys(e).forEach(function(o){if(typeof t=="string"){n[o]=t;return}var i=t[o];if(typeof i!="undefined"){n[o]=i;return}var a=t["*"];if(typeof a!="undefined"){n[o]=a;return}n[o]=r}),n}function Pi(e,t){var r={};for(var n in e){var o=e[n];e.hasOwnProperty(n)&&o&&t[n]!==null&&typeof o.isolateSource=="function"?r[n]=o.isolateSource(o,t[n]):e.hasOwnProperty(n)&&(r[n]=e[n])}return r}function Ci(e,t,r){var n={};for(var o in t){var i=e[o],a=t[o];t.hasOwnProperty(o)&&i&&r[o]!==null&&typeof i.isolateSink=="function"?n[o]=z(i.isolateSink(S.fromObservable(a),r[o])):t.hasOwnProperty(o)&&(n[o]=t[o])}return n}var tn=0;function er(){return"cycle"+ ++tn}function gt(e,t){t===void 0&&(t=er()),$i(e,t);var r=typeof t=="object"?er():"",n=typeof t=="string"||typeof t=="object"?t:t.toString();return function(i){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];var u=Ni(i,n,r),c=Pi(i,u),p=e.apply(void 0,[c].concat(a)),f=Ci(i,p,u);return f}}gt.reset=function(){return tn=0};var ie={};Object.defineProperty(ie,"__esModule",{value:!0});ie.DropRepeatsOperator=void 0;var Ii=G,de={},en=function(){function e(t,r){this.ins=t,this.type="dropRepeats",this.out=null,this.v=de,this.isEq=r||function(n,o){return n===o}}return e.prototype._start=function(t){this.out=t,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=null,this.v=de},e.prototype._n=function(t){var r=this.out;if(!!r){var n=this.v;n!==de&&this.isEq(t,n)||(this.v=t,r._n(t))}},e.prototype._e=function(t){var r=this.out;!r||r._e(t)},e.prototype._c=function(){var t=this.out;!t||t._c()},e}();ie.DropRepeatsOperator=en;function Ti(e){return e===void 0&&(e=void 0),function(r){return new Ii.Stream(new en(r,e))}}var Rt=ie.default=Ti,Se=globalThis&&globalThis.__assign||function(){return Se=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Se.apply(this,arguments)};function Di(e,t,r){if(r===e[t])return e;var n=parseInt(t);return typeof r=="undefined"?e.filter(function(o,i){return i!==n}):e.map(function(o,i){return i===n?r:o})}function rn(e){return typeof e=="string"||typeof e=="number"?function(r){if(typeof r!="undefined")return r[e]}:e.get}function ki(e){return typeof e=="string"||typeof e=="number"?function(r,n){var o,i;return Array.isArray(r)?Di(r,e,n):typeof r=="undefined"?(o={},o[e]=n,o):Se({},r,(i={},i[e]=n,i))}:e.set}function xi(e,t){return e.select(t)}function Mi(e,t){var r=rn(t),n=ki(t);return e.map(function(o){return function(a){var s=r(a),u=o(s);return s===u?a:n(a,u)}})}var Ot=function(){function e(t,r){this.isolateSource=xi,this.isolateSink=Mi,this._stream=t.filter(function(n){return typeof n!="undefined"}).compose(Rt()).remember(),this._name=r,this.stream=z(this._stream),this._stream._isCycleSource=r}return e.prototype.select=function(t){var r=rn(t);return new e(this._stream.map(r),this._name)},e}(),ji=function(){function e(t,r,n){this.ins=n,this.out=t,this.p=r}return e.prototype._n=function(t){this.p;var r=this.out;r!==null&&r._n(t)},e.prototype._e=function(t){var r=this.out;r!==null&&r._e(t)},e.prototype._c=function(){},e}(),Li=function(){function e(t,r){this.type="pickMerge",this.ins=r,this.out=null,this.sel=t,this.ils=new Map,this.inst=null}return e.prototype._start=function(t){this.out=t,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this);var t=this.ils;t.forEach(function(r,n){r.ins._remove(r),r.ins=null,r.out=null,t.delete(n)}),t.clear(),this.out=null,this.ils=new Map,this.inst=null},e.prototype._n=function(t){this.inst=t;for(var r=t.arr,n=this.ils,o=this.out,i=this.sel,a=r.length,s=0;s<a;++s){var u=r[s],c=u._key,p=S.fromObservable(u[i]||S.never());n.has(c)||(n.set(c,new ji(o,this,p)),p._add(n.get(c)))}n.forEach(function(f,h){(!t.dict.has(h)||!t.dict.get(h))&&(f.ins._remove(f),f.ins=null,f.out=null,n.delete(h))})},e.prototype._e=function(t){var r=this.out;r!==null&&r._e(t)},e.prototype._c=function(){var t=this.out;t!==null&&t._c()},e}();function Fi(e){return function(r){return new et(new Li(e,r))}}var Ri=function(){function e(t,r,n,o){this.key=t,this.out=r,this.p=n,this.val=xe,this.ins=o}return e.prototype._n=function(t){this.p;var r=this.out;this.val=t,r!==null&&this.p.up()},e.prototype._e=function(t){var r=this.out;r!==null&&r._e(t)},e.prototype._c=function(){},e}(),Bi=function(){function e(t,r){this.type="combine",this.ins=r,this.sel=t,this.out=null,this.ils=new Map,this.inst=null}return e.prototype._start=function(t){this.out=t,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this);var t=this.ils;t.forEach(function(r){r.ins._remove(r),r.ins=null,r.out=null,r.val=null}),t.clear(),this.out=null,this.ils=new Map,this.inst=null},e.prototype.up=function(){for(var t=this.inst.arr,r=t.length,n=this.ils,o=Array(r),i=0;i<r;++i){var a=t[i],s=a._key;if(!n.has(s))return;var u=n.get(s).val;if(u===xe)return;o[i]=u}this.out._n(o)},e.prototype._n=function(t){this.inst=t;var r=t.arr,n=this.ils,o=this.out,i=this.sel,a=t.dict,s=r.length,u=!1;if(n.forEach(function(b,l){a.has(l)||(b.ins._remove(b),b.ins=null,b.out=null,b.val=null,n.delete(l),u=!0)}),s===0){o._n([]);return}for(var c=0;c<s;++c){var p=r[c],f=p._key;if(!p[i])throw new Error("pickCombine found an undefined child sink stream");var h=S.fromObservable(p[i]);n.has(f)||(n.set(f,new Ri(f,o,this,h)),h._add(n.get(f)))}u&&this.up()},e.prototype._e=function(t){var r=this.out;r!==null&&r._e(t)},e.prototype._c=function(){var t=this.out;t!==null&&t._c()},e}();function Ui(e){return function(r){return new et(new Bi(e,r))}}var te=globalThis&&globalThis.__assign||function(){return te=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},te.apply(this,arguments)},Wi=function(){function e(t){this._instances$=t}return e.prototype.pickMerge=function(t){return z(this._instances$.compose(Fi(t)))},e.prototype.pickCombine=function(t){return z(this._instances$.compose(Ui(t)))},e}();function qi(e){return{"*":null}}function Gi(e,t){return{get:function(r){if(typeof r!="undefined"){for(var n=0,o=r.length;n<o;++n)if(""+e(r[n],n)===t)return r[n];return}},set:function(r,n){return typeof r=="undefined"?[n]:typeof n=="undefined"?r.filter(function(o,i){return""+e(o,i)!==t}):r.map(function(o,i){return""+e(o,i)===t?n:o})}}}var Hi={get:function(e){return e},set:function(e,t){return t}};function zi(e){return function(r){var n=e.channel||"state",o=e.itemKey,i=e.itemScope||qi,a=S.fromObservable(r[n].stream),s=a.fold(function(u,c){var p,f,h,b,l=u.dict;if(Array.isArray(c)){for(var d=Array(c.length),m=new Set,y=0,A=c.length;y<A;++y){var g=""+(o?o(c[y],y):y);if(m.add(g),l.has(g))d[y]=l.get(g);else{var _=o?Gi(o,g):""+y,w=i(g),E=typeof w=="string"?(p={"*":w},p[n]=_,p):te({},w,(f={},f[n]=_,f)),$=e.itemFactory?e.itemFactory(c[y],y):e.item,O=gt($,E)(r);l.set(g,O),d[y]=O}d[y]._key=g}return l.forEach(function(N,P){m.has(P)||l.delete(P)}),m.clear(),{dict:l,arr:d}}else{l.clear();var g=""+(o?o(c,0):"this"),_=Hi,w=i(g),E=typeof w=="string"?(h={"*":w},h[n]=_,h):te({},w,(b={},b[n]=_,b)),$=e.itemFactory?e.itemFactory(c,0):e.item,O=gt($,E)(r);return l.set(g,O),{dict:l,arr:[O]}}},{dict:new Map,arr:[]});return e.collectSinks(new Wi(s))}}var nn={};Object.defineProperty(nn,"__esModule",{value:!0});var Ki=G,Vi=function(){function e(t){this.streams=t,this.type="concat",this.out=null,this.i=0}return e.prototype._start=function(t){this.out=t,this.streams[this.i]._add(this)},e.prototype._stop=function(){var t=this.streams;this.i<t.length&&t[this.i]._remove(this),this.i=0,this.out=null},e.prototype._n=function(t){var r=this.out;!r||r._n(t)},e.prototype._e=function(t){var r=this.out;!r||r._e(t)},e.prototype._c=function(){var t=this.out;if(!!t){var r=this.streams;r[this.i]._remove(this),++this.i<r.length?r[this.i]._add(this):t._c()}},e}();function Ji(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new Ki.Stream(new Vi(e))}var ee=nn.default=Ji,on={};Object.defineProperty(on,"__esModule",{value:!0});function Yi(){return typeof queueMicrotask!="undefined"?queueMicrotask:typeof setImmediate!="undefined"?setImmediate:typeof process!="undefined"?process.nextTick:setTimeout}var an=on.default=Yi,he=an();function Xi(e,t){return t===void 0&&(t="state"),function(n){var o=S.create(),i=o.fold(function(c,p){return p(c)},void 0).drop(1),a=n;a[t]=new Ot(i,t);var s=e(a);if(s[t]){var u=ee(S.fromObservable(s[t]),S.never());u.subscribe({next:function(c){return he(function(){return o._n(c)})},error:function(c){return he(function(){return o._e(c)})},complete:function(){return he(function(){return o._c()})}})}return s}}function Zi(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qi(e,t){return na(e)||ra(e,t)||ea(e,t)||ta()}function ta(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ea(e,t){if(!!e){if(typeof e=="string")return rr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rr(e,t)}}function rr(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ra(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(u){i=!0,s=u}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function na(e){if(Array.isArray(e))return e}function oa(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=r.combineList,o=n===void 0?["DOM"]:n,i=r.globalList,a=i===void 0?["EVENTS"]:i,s=r.stateSourceName,u=s===void 0?"STATE":s,c=r.domSourceName,p=c===void 0?"DOM":c,f=r.container,h=f===void 0?"div":f,b=r.containerClass;return function(l){var d=Date.now(),m={item:e,itemKey:function(g,_){return typeof g.id!="undefined"?g.id:_},itemScope:function(g){return g},channel:u,collectSinks:function(g){return Object.entries(l).reduce(function(_,w){var E=Qi(w,2),$=E[0];if(E[1],o.includes($)){var O=g.pickCombine($);$===p&&h?_.DOM=O.map(function(N){var P=b?{props:{className:b}}:{};return{sel:h,data:P,children:N,key:d,text:void 0,elm:void 0}}):(console.warn("Collections without wrapping containers will fail in unpredictable ways when used inside JSX fragments"),_[$]=O)}else _[$]=g.pickMerge($);return _},{})}},y=Zi({},u,t);return a.forEach(function(A){return y[A]=null}),o.forEach(function(A){return y[A]=null}),ia(m,y,l)}}function ia(e,t,r){return gt(zi(e),t)(r)}function aa(e){return ca(e)||ua(e)||sn(e)||sa()}function sa(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ua(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ca(e){if(Array.isArray(e))return Oe(e)}function nr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function or(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nr(Object(r),!0).forEach(function(n){fa(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nr(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fa(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _t(e,t){return da(e)||pa(e,t)||sn(e,t)||la()}function la(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sn(e,t){if(!!e){if(typeof e=="string")return Oe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Oe(e,t)}}function Oe(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pa(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(u){i=!0,s=u}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function da(e){if(Array.isArray(e))return e}function Ae(e){return Ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ae(e)}function ir(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},o=n.switched,i=o===void 0?["DOM"]:o,a=n.stateSourceName,s=a===void 0?"STATE":a,u=Ae(t);if(!t)throw new Error("Missing 'name$' parameter for switchable()");if(!(u==="string"||u==="function"||t instanceof et))throw new Error("Invalid 'name$' parameter for switchable(): expects Stream, String, or Function");if(t instanceof et){var c=t.compose(Rt()).startWith(r).remember();return function(f){return ar(e,f,c,i)}}else{var p=u==="function"&&t||function(f){return f[t]};return function(f){var h=f&&(typeof s=="string"&&f[s]||f.STATE||f.state).stream;if(!h instanceof et)throw new Error("Could not find the state source: ".concat(s));var b=h.map(p).filter(function(l){return typeof l=="string"}).compose(Rt()).startWith(r).remember();return ar(e,f,b,i,s)}}}function ar(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:["DOM"],o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"STATE";typeof n=="string"&&(n=[n]);var i=Object.entries(e).map(function(s){var u=_t(s,2),c=u[0],p=u[1];if(t[o]){var f=t[o].stream,h=S.combine(r,f).filter(function(l){var d=_t(l,2),m=d[0];return d[1],m==c}).map(function(l){var d=_t(l,2);d[0];var m=d[1];return m}).remember(),b=new t[o].constructor(h,t[o]._name);return[c,p(or(or({},t),{},{state:b}))]}return[c,p(t)]}),a=Object.keys(t).reduce(function(s,u){if(n.includes(u))s[u]=r.map(function(p){var f=i.find(function(h){var b=_t(h,2),l=b[0];return b[1],l===p});return f&&f[1][u]||S.never()}).flatten().remember().startWith(void 0);else{var c=i.filter(function(p){var f=_t(p,2);f[0];var h=f[1];return h[u]!==void 0}).map(function(p){var f=_t(p,2);f[0];var h=f[1];return h[u]});s[u]=S.merge.apply(S,aa(c))}return s},{});return a}var un={};Object.defineProperty(un,"__esModule",{value:!0});var ha=G,ya=function(){function e(t,r){this.dt=t,this.ins=r,this.type="delay",this.out=null}return e.prototype._start=function(t){this.out=t,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=null},e.prototype._n=function(t){var r=this.out;if(!!r)var n=setInterval(function(){r._n(t),clearInterval(n)},this.dt)},e.prototype._e=function(t){var r=this.out;if(!!r)var n=setInterval(function(){r._e(t),clearInterval(n)},this.dt)},e.prototype._c=function(){var t=this.out;if(!!t)var r=setInterval(function(){t._c(),clearInterval(r)},this.dt)},e}();function va(e){return function(r){return new ha.Stream(new ya(e,r))}}var sr=un.default=va,cn={};Object.defineProperty(cn,"__esModule",{value:!0});var xt=G,ma=function(){function e(t,r){this.dt=t,this.ins=r,this.type="debounce",this.out=null,this.id=null,this.t=xt.NO}return e.prototype._start=function(t){this.out=t,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=null,this.clearInterval()},e.prototype.clearInterval=function(){var t=this.id;t!==null&&clearInterval(t),this.id=null},e.prototype._n=function(t){var r=this,n=this.out;!n||(this.clearInterval(),this.t=t,this.id=setInterval(function(){r.clearInterval(),n._n(t),r.t=xt.NO},this.dt))},e.prototype._e=function(t){var r=this.out;!r||(this.clearInterval(),r._e(t))},e.prototype._c=function(){var t=this.out;!t||(this.clearInterval(),this.t!=xt.NO&&t._n(this.t),this.t=xt.NO,t._c())},e}();function ga(e){return function(r){return new xt.Stream(new ma(e,r))}}var Ht=cn.default=ga,ba=["state","sygnalFactory","id"];function _a(e,t){if(e==null)return{};var r=wa(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,n)||(r[n]=e[n]))}return r}function wa(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function W(e){return Aa(e)||Oa(e)||fn(e)||Sa()}function Sa(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Oa(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Aa(e){if(Array.isArray(e))return Ee(e)}function U(e,t){return Na(e)||$a(e,t)||fn(e,t)||Ea()}function Ea(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fn(e,t){if(!!e){if(typeof e=="string")return Ee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ee(e,t)}}function Ee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $a(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(u){i=!0,s=u}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function Na(e){if(Array.isArray(e))return e}function Pa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ur(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ca(e,t,r){return t&&ur(e.prototype,t),r&&ur(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cr(Object(r),!0).forEach(function(n){B(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cr(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function B(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M(e){return M=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M(e)}var $e=typeof window!="undefined"&&window||process&&process.env||{},fr="request",Ia="BOOTSTRAP",wt="INITIALIZE",Ta="HYDRATE",lr=!0,At="~#~#~ABORT~#~#~";function ln(e){var t=e.name,r=e.sources,n=e.isolateOpts,o=e.stateSourceName,i=o===void 0?"STATE":o;if(r&&M(r)!=="object")throw new Error("Sources must be a Cycle.js sources object:",t);var a;typeof n=="string"?a=B({},i,n):n===!0?a={}:a=n;var s=typeof r=="undefined";if(M(a)=="object"){var u=function(p){var f=I(I({},e),{},{sources:p});return new ye(f).sinks};return s?gt(u,a):gt(u,a)(r)}else return s?function(c){return new ye(I(I({},e),{},{sources:c})).sinks}:new ye(e).sinks}var ye=function(){function e(t){var r=this,n=t.name,o=n===void 0?"NO NAME":n,i=t.sources,a=t.intent,s=t.request,u=t.model,c=t.response,p=t.view,f=t.children,h=f===void 0?{}:f,b=t.components,l=b===void 0?{}:b,d=t.initialState,m=t.calculated,y=t.storeCalculatedInState,A=y===void 0?!0:y,g=t.DOMSourceName,_=g===void 0?"DOM":g,w=t.stateSourceName,E=w===void 0?"STATE":w,$=t.requestSourceName,O=$===void 0?"HTTP":$;if(Pa(this,e),!i||M(i)!="object")throw new Error("Missing or invalid sources");this.name=o,this.sources=i,this.intent=a,this.request=s,this.model=u,this.response=c,this.view=p,this.children=h,this.components=l,this.initialState=d,this.calculated=m,this.storeCalculatedInState=A,this.DOMSourceName=_,this.stateSourceName=E,this.requestSourceName=O,this.sourceNames=Object.keys(i),this.isSubComponent=this.sourceNames.includes("props$");var N=i[E]&&i[E].stream;N&&(this.currentState=d||{},this.sources[this.stateSourceName]=new Ot(N.map(function(P){return r.currentState=P,P}))),lr&&typeof this.intent=="undefined"&&typeof this.model=="undefined"&&(this.initialState=d||!0,this.intent=function(P){return{__NOOP_ACTION__:S.never()}},this.model={__NOOP_ACTION__:function(T){return T}}),lr=!1,this.log=Da(o),this.initIntent$(),this.initAction$(),this.initResponse$(),this.initState(),this.initModel$(),this.initSendResponse$(),this.initChildren$(),this.initSubComponentSink$(),this.initVdom$(),this.initSinks()}return Ca(e,[{key:"initIntent$",value:function(){if(!!this.intent){if(typeof this.intent!="function")throw new Error("Intent must be a function");if(this.intent$=this.intent(this.sources),!(this.intent$ instanceof et)&&M(this.intent$)!="object")throw new Error("Intent must return either an action$ stream or map of event streams")}}},{key:"initAction$",value:function(){var r=this.sources&&this.sources[this.requestSourceName]||null;if(!this.intent$){this.action$=S.never();return}var n;if(this.intent$ instanceof et)n=this.intent$;else{var o=Object.entries(this.intent$).map(function(c){var p=U(c,2),f=p[0],h=p[1];return h.map(function(b){return{type:f,data:b}})});n=S.merge.apply(S,[S.never()].concat(W(o)))}var i=n instanceof et?n:n.apply&&n(this.sources)||S.never(),a=ee(S.of({type:Ia}),i).compose(sr(10)),s;r&&typeof r.select=="function"?s=r.select("initial").flatten():s=S.never();var u=s.map(function(c){return{type:Ta,data:c}});this.action$=S.merge(a,u).compose(this.log(function(c){var p=c.type;return"Action triggered: <".concat(p,">")}))}},{key:"initResponse$",value:function(){var r=this;if(typeof this.request!="undefined"){if(M(this.request)!="object")throw new Error("The request parameter must be an object");var n=this.sources[this.requestSourceName],o=Object.entries(this.request),i=o.reduce(function(a,s){var u=U(s,2),c=u[0],p=u[1],f=c.toLowerCase();if(typeof n[f]!="function")throw new Error("Invalid method in request object:",c);var h=Object.entries(p),b=h.reduce(function(d,m){var y=U(m,2),A=y[0],g=y[1],_="[".concat(f.toUpperCase(),"]:").concat(A||"none"),w=M(g);if(w==="undefined")throw new Error("Action for '".concat(A,"' route in request object not specified"));if(w!=="string"&&w!=="function")throw new Error("Invalid action for '".concat(A,"' route: expecting string or function"));var E=w==="function"?"[ FUNCTION ]":"< ".concat(g," >");console.log("[".concat(r.name,"] Adding ").concat(r.requestSourceName," route:"),f.toUpperCase(),"'".concat(A,"' <").concat(E,">"));var $=n[f](A).compose(Rt(function(O,N){return O.id==N.id})).map(function(O){if(!O||!O.id)throw new Error("No id found in request: ".concat(_));try{var N=O.id,P=O.params,T=O.body,k=O.cookies,j=w==="function"?"FUNCTION":g,rt={params:P,body:T,cookies:k,req:O},nt={type:j,data:T,req:O,_reqId:N,_action:j},Bt=new Date().toISOString(),Pt=O.get?O.get("host"):"0.0.0.0";if(console.log("".concat(Bt," ").concat(Pt," ").concat(O.method," ").concat(O.url)),$e.DEBUG&&r.action$.setDebugListener({next:function(Y){var X=Y.type;return console.log("[".concat(r.name,"] Action from ").concat(r.requestSourceName," request: <").concat(X,">"))}}),w==="function"){var Ct=r.addCalculated(r.currentState),K=g(Ct,O);return S.of(I(I({},nt),{},{data:K}))}else{r.action$.shamefullySendNext(nt);var lt=Object.entries(r.sources),J=lt.reduce(function(F,Y){var X=U(Y,2),pt=X[0],ot=X[1];if(!ot||typeof ot[fr]!="function")return F;var Ut=ot[fr](N);return[].concat(W(F),[Ut])},[]);return S.merge.apply(S,W(J))}}catch(F){console.error(F)}}).flatten();return[].concat(W(d),[$])},[]),l=S.merge.apply(S,W(b));return[].concat(W(a),[l])},[]);if(this.response$=S.merge.apply(S,W(i)).compose(this.log(function(a){return a._action?"[".concat(r.requestSourceName,"] response data received for Action: <").concat(a._action,">"):"[".concat(r.requestSourceName,"] response data received from FUNCTION")})),typeof this.response!="undefined"&&typeof this.response$=="undefined")throw new Error("Cannot have a response parameter without a request parameter")}}},{key:"initState",value:function(){var r=this;this.model!=null&&(this.model[wt]===void 0?this.model[wt]=B({},this.stateSourceName,function(n,o){return I({},r.addCalculated(o))}):Object.keys(this.model[wt]).forEach(function(n){n!==r.stateSourceName&&(console.warn("".concat(wt," can only be used with the ").concat(r.stateSourceName," source... disregarding ").concat(n)),delete r.model[wt][n])}))}},{key:"initModel$",value:function(){var r=this;if(typeof this.model=="undefined"){this.model$=this.sourceNames.reduce(function(p,f){return p[f]=S.never(),p},{});return}var n={type:wt,data:this.initialState},o=this.initialState?ee(S.of(n),this.action$).compose(sr(0)):this.action$,i=this.makeOnAction(o,!0,this.action$),a=this.makeOnAction(this.action$,!1,this.action$),s=Object.entries(this.model),u={};s.forEach(function(p){var f=U(p,2),h=f[0],b=f[1];if(typeof b=="function"&&(b=B({},r.stateSourceName,b)),M(b)!=="object")throw new Error("Entry for each action must be an object: ".concat(r.name," ").concat(h));var l=Object.entries(b);l.forEach(function(d){var m=U(d,2),y=m[0],A=m[1],g=y==r.stateSourceName,_=g?i:a,w=_(h,A),E=w.compose(r.log(function($){if(g)return"State reducer added: <".concat(h,">");var O=$&&($.type||$.command||$.name||$.key||Array.isArray($)&&"Array"||$);return"Data sent to [".concat(y,"]: <").concat(h,"> ").concat(O)}));Array.isArray(u[y])?u[y].push(E):u[y]=[E]})});var c=Object.entries(u).reduce(function(p,f){var h=U(f,2),b=h[0],l=h[1];return p[b]=S.merge.apply(S,[S.never()].concat(W(l))),p},{});this.model$=c}},{key:"initSendResponse$",value:function(){var r=this,n=M(this.response);if(n!="function"&&n!="undefined")throw new Error("The response parameter must be a function");if(n=="undefined"){this.response$&&this.response$.subscribe({next:this.log(function(u){var c=u._reqId,p=u._action;return"Unhandled response for request: ".concat(p," ").concat(c)})}),this.sendResponse$=S.never();return}var o={select:function(c){return typeof c=="undefined"?r.response$:(Array.isArray(c)||(c=[c]),r.response$.filter(function(p){var f=p._action;return c.length>0?f==="FUNCTION"||c.includes(f):!0}))}},i=this.response(o);if(M(i)!="object")throw new Error("The response function must return an object");var a=Object.entries(i),s=a.reduce(function(u,c){var p=U(c,2),f=p[0],h=p[1],b=h.map(function(l){var d=l._reqId,m=l._action,y=l.data;if(!d)throw new Error("No request id found for response for: ".concat(f));return{_reqId:d,_action:m,command:f,data:y}});return[].concat(W(u),[b])},[]);this.sendResponse$=S.merge.apply(S,W(s)).compose(this.log(function(u){u._reqId;var c=u._action;return"[".concat(r.requestSourceName,"] response sent for: <").concat(c,">")}))}},{key:"initChildren$",value:function(){var r=this,n=this.sourceNames.reduce(function(o,i){return i==r.DOMSourceName?o[i]={}:o[i]=[],o},{});this.children$=Object.entries(this.children).reduce(function(o,i){var a=U(i,2),s=a[0],u=a[1],c=u(r.sources);return r.sourceNames.forEach(function(p){p==r.DOMSourceName?o[p][s]=c[p]:o[p].push(c[p])}),o},n)}},{key:"initSubComponentSink$",value:function(){var r=this,n=S.create({start:function(i){r.newSubComponentSinks=i.next.bind(i)},stop:function(i){}});n.subscribe({next:function(i){return i}}),this.subComponentSink$=n.filter(function(o){return Object.keys(o).length>0})}},{key:"initVdom$",value:function(){var r=this;if(typeof this.view!="function"){this.vdom$=S.of(null);return}var n=this.sources[this.stateSourceName],o=I({},this.children$[this.DOMSourceName]),i=n&&n.isolateSource(n,{get:function(d){return r.addCalculated(d)}}),a=i&&i.stream||S.never();o.state=a,o[this.stateSourceName]=a,this.sources.props$&&(o.props=this.sources.props$),this.sources.children$&&(o.children=this.sources.children$);var s=Object.entries(o).reduce(function(l,d){var m=U(d,2),y=m[0],A=m[1];return l.names.push(y),l.streams.push(A),l},{names:[],streams:[]}),u=S.combine.apply(S,W(s.streams)),c=u.compose(Ht(5)).map(function(l){return s.names.reduce(function(d,m,y){return d[m]=l[y],d},{})}),p=Object.keys(this.components),f=S.create(),h=c.map(function(l){return l}).map(this.view).map(function(l){return l||{sel:"div",data:{},children:[]}}),b=h.fold(function(l,d){var m=pn(d,p),y=Object.entries(m),A={"::ROOT::":d};if(y.length===0)return A;var g={},_=y.reduce(function(E,$){var O=U($,2),N=O[0],P=O[1],T=P.sel,k=P.data,j=k.props||{},rt=P.children||[],nt=k.isCollection||!1,Bt=k.isSwitchable||!1;if(l[N]){var Pt=l[N];return E[N]=Pt,Pt.props$.shamefullySendNext(j),Pt.children$.shamefullySendNext(rt),E}var Ct=T==="sygnal-factory"?j.sygnalFactory:r.components[T]||j.sygnalFactory;if(!Ct&&!nt&&!Bt)throw T==="sygnal-factory"?new Error("Component not found on element with Capitalized selector and nameless function: JSX transpilation replaces selectors starting with upper case letters with functions in-scope with the same name, Sygnal cannot see the name of the resulting component."):new Error("Component not found: ".concat(T));var K=S.create().startWith(j),lt=S.create().startWith(rt),J=new Ot(r.sources[r.stateSourceName].stream.startWith(r.currentState)),F,Y=!0;if(nt){var X,pt,ot,Ut=function(x){var L=x[pt];if(typeof L!="undefined"){if(!Array.isArray(L)){var at=typeof k.props.of=="string"?k.props.of:"components";return console.warn("Collection of ".concat(at," does not have a valid array in the 'for' property: expects either an array or a string of the name of an array property on the state")),[]}return L}};typeof j.for=="undefined"?(ot={get:function(x){return Array.isArray(x)?x:(console.warn("Collection sub-component of ".concat(r.name," has no 'for' attribute and the parent state is not an array: Provide a 'for' attribute with either an array or the name of a state property containing an array")),[])},set:function(x,L){return L}},Y=!1):typeof j.for=="string"?(pt=j.for,ot={get:Ut,set:function(x,L){return r.calculated&&pt in r.calculated?(console.warn("Collection sub-component of ".concat(r.name," attempted to update state on a calculated field '").concat(pt,"': Update ignored")),x):I(I({},x),{},B({},pt,L))}},Y=!1):(pt="for",J=new Ot(K.remember()),ot={get:Ut,set:function(x,L){return x}});var Fn=I(I({},r.sources),{},(X={},B(X,r.stateSourceName,J),B(X,"props$",K),B(X,"children$",lt),X)),Rn=typeof k.props.of=="function"?k.props.of:r.components[k.props.of];if(F=oa(Rn,ot,{container:null})(Fn),M(F)!=="object")throw new Error("Invalid sinks returned from component factory of collection element")}else if(Bt){var It,it=k.props.state,ae=!1,se;if(typeof it=="string")ae=!0,se={get:function(x){return x[it]},set:function(x,L){return r.calculated&&it in r.calculated?(console.warn("Switchable sub-component of ".concat(r.name," attempted to update state on a calculated field '").concat(it,"': Update ignored")),x):I(I({},x),{},B({},it,L))}},Y=!1;else if(typeof it=="undefined")ae=!0,se={get:function(x){return x},set:function(x,L){return L}},Y=!1;else if(M(it)==="object")J=new Ot(K.map(function(R){return R.state}));else throw new Error("Invalid state provided to collection sub-component of ".concat(r.name,": Expecting string, object, or none, but found ").concat(M(it)));var Ue=k.props.of,We=I(I({},r.sources),{},(It={},B(It,r.stateSourceName,J),B(It,"props$",K),B(It,"children$",lt),It));if(ae?F=gt(ir(Ue,K.map(function(R){return R.current})),B({},r.stateSourceName,se))(We):F=ir(Ue,K.map(function(R){return R.current}))(We),M(F)!=="object")throw new Error("Invalid sinks returned from component factory of switchable element")}else{var Bn=j.state;j.sygnalFactory,j.id;var qe=_a(j,ba);if(typeof Bn=="undefined"&&(M(qe)!=="object"||Object.keys(qe).length===0)){var Tt,Un=I(I({},r.sources),{},(Tt={},B(Tt,r.stateSourceName,J),B(Tt,"props$",S.never().startWith(null)),B(Tt,"children$",lt),Tt));F=Ct(Un),Y=!1}else{var Dt,Wn=function(x){var L=x.state;if(typeof L=="undefined")return x;if(M(L)!=="object")return L;var at=I({},x);return delete at.state,I(I({},at),L)};J=new Ot(K.map(Wn));var qn=I(I({},r.sources),{},(Dt={},B(Dt,r.stateSourceName,J),B(Dt,"props$",K),B(Dt,"children$",lt),Dt));F=Ct(qn)}if(M(F)!=="object"){var Gn=T==="sygnal-factory"?"custom element":T;throw new Error("Invalid sinks returned from component factory:",Gn)}}if(Y){var Hn=F[r.stateSourceName];F[r.stateSourceName]=Hn.filter(function(R){return console.warn("State update attempt from component with inderect link to state: Components with state set through HTML properties/attributes cannot update application state directly"),!1})}var zn=F[r.DOMSourceName].remember(),Kn=function(x,L){var at=JSON.stringify(x),Vn=JSON.stringify(L);return at===Vn};return F[r.DOMSourceName]=J.stream.compose(Rt(Kn)).map(function(R){return f.shamefullySendNext(null),zn}).compose(Ht(10)).flatten().remember(),E[N]={sink$:F,props$:K,children$:lt},Object.entries(F).map(function(R){var x=U(R,2),L=x[0],at=x[1];g[L]||(g[L]=[]),L!==r.DOMSourceName&&g[L].push(at)}),E},A),w=Object.entries(g).reduce(function(E,$){var O=U($,2),N=O[0],P=O[1];return P.length===0||(E[N]=P.length===1?P[0]:S.merge.apply(S,W(P))),E},{});return r.newSubComponentSinks(w),_},{});this.vdom$=S.combine(f.startWith(null),b).map(function(l){var d=U(l,2);d[0];var m=d[1],y=m["::ROOT::"],A=[],g=Object.entries(m).filter(function(w){var E=U(w,1),$=E[0];return $!=="::ROOT::"});if(g.length===0)return S.of(y);var _=g.map(function(w){var E=U(w,2),$=E[0],O=E[1];return A.push($),O.sink$[r.DOMSourceName].startWith(void 0)});return _.length===0?S.of(y):S.combine.apply(S,W(_)).compose(Ht(5)).map(function(w){var E=w.reduce(function(N,P,T){return N[A[T]]=P,N},{}),$=yn(y),O=dn($,E,p);return O})}).flatten().filter(function(l){return!!l}).compose(Ht(5)).remember().compose(this.log("View Rendered"))}},{key:"initSinks",value:function(){var r=this;this.sinks=this.sourceNames.reduce(function(n,o){if(o==r.DOMSourceName)return n;var i=r.subComponentSink$?r.subComponentSink$.map(function(a){return a[o]}).filter(function(a){return!!a}).flatten():S.never();return o===r.stateSourceName?n[o]=S.merge.apply(S,[r.model$[o]||S.never(),i,r.sources[r.stateSourceName].stream.filter(function(a){return!1})].concat(W(r.children$[o]))):n[o]=S.merge.apply(S,[r.model$[o]||S.never(),i].concat(W(r.children$[o]))),n},{}),this.sinks[this.DOMSourceName]=this.vdom$,this.sinks[this.requestSourceName]=S.merge(this.sendResponse$,this.sinks[this.requestSourceName])}},{key:"makeOnAction",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2?arguments[2]:void 0;return i=i||r,function(a,s){var u=r.filter(function(f){var h=f.type;return h==a}),c;if(typeof s=="function")c=u.map(function(f){var h=function(g,_){var w=f._reqId||f.req&&f.req.id,E=w?M(_)=="object"?I(I({},_),{},{_reqId:w,_action:a}):{data:_,_reqId:w,_action:a}:_;setTimeout(function(){i.shamefullySendNext({type:g,data:E})},10)},b=f.data;if(b&&b.data&&b._reqId&&(b=b.data),o)return function(A){var g=n.isSubComponent?n.currentState:A,_=n.addCalculated(g),w=s(_,b,h,f.req);return w==At?g:n.cleanupCalculated(w)};var l=n.addCalculated(n.currentState),d=s(l,b,h,f.req),m=M(d),y=f._reqId||f.req&&f.req.id;if(["string","number","boolean","function"].includes(m))return d;if(m=="object")return I(I({},d),{},{_reqId:y,_action:a});if(m=="undefined")return console.warn("'undefined' value sent to ".concat(a)),d;throw new Error("Invalid reducer type for ".concat(a," ").concat(m))}).filter(function(f){return f!=At});else if(s===void 0||s===!0)c=u.map(function(f){var h=f.data;return h});else{var p=s;c=u.mapTo(p)}return c}}},{key:"addCalculated",value:function(r){if(!this.calculated||M(r)!=="object")return r;if(M(this.calculated)!=="object")throw new Error("'calculated' parameter must be an object mapping calculated state field named to functions");var n=Object.entries(this.calculated),o=n.reduce(function(i,a){var s=U(a,2),u=s[0],c=s[1];if(typeof c!="function")throw new Error("Missing or invalid calculator function for calculated field '".concat(u));try{i[u]=c(r)}catch(p){console.warn("Calculated field '".concat(u,"' threw an error during calculation: ").concat(p.message))}return i},{});return I(I({},r),o)}},{key:"cleanupCalculated",value:function(r){var n=this;if(this.storeCalculatedInState)return this.addCalculated(r);if(!this.calculated||!r||M(r)!=="object")return r;var o=Object.keys(this.calculated),i=I({},r);return o.forEach(function(a){n.initialState&&typeof n.initialState[a]!="undefined"?i[a]=n.initialState[a]:delete i[a]}),i}}]),e}();function Da(e){return function(t){var r=typeof t=="function"?t:function(n){return t};return function(n){return n.debug(function(o){($e.DEBUG=="true"||$e.DEBUG===!0)&&console.log("[".concat(e,"] ").concat(r(o)))})}}}function pn(e,t){var r,n,o,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(!e)return{};if((r=e.data)!==null&&r!==void 0&&r.componentsProcessed)return{};i===0&&(e.data.componentsProcessed=!0);var s=e.sel,u=s&&s.toLowerCase()==="collection",c=s&&s.toLowerCase()==="switchable",p=s&&["collection","switchable","sygnal-factory"].concat(W(t)).includes(e.sel)||typeof((n=e.data)===null||n===void 0||(o=n.props)===null||o===void 0?void 0:o.sygnalFactory)=="function",f=e.data&&e.data.props||{},h=e.data&&e.data.attrs||{},b=e.children||[],l={};if(p){var d=hn(e,i,a);if(u){var m;if(!f.of)throw new Error("Collection element missing required 'component' property");if(typeof f.of!="string"&&typeof f.of!="function")throw new Error("Invalid 'component' property of collection element: found ".concat(M(f.of)," requires string or component factory function"));if(typeof f.of!="function"&&!t.includes(f.of))throw new Error("Specified component for collection not found: ".concat(f.of));typeof h.for!="undefined"&&!(typeof h.for=="string"||Array.isArray(h.for))&&console.warn("No valid array found in the 'value' property of collection ".concat(typeof f.of=="string"?f.of:"function component",": no collection components will be created")),e.data.isCollection=!0,(m=e.data).props||(m.props={}),e.data.props.for=h.for,e.data.attrs=void 0}else if(c){if(!f.of)throw new Error("Switchable element missing required 'of' property");if(M(f.of)!=="object")throw new Error("Invalid 'components' property of switchable element: found ".concat(M(f.of)," requires object mapping names to component factories"));var y=Object.values(f.of);if(!y.every(function(g){return typeof g=="function"}))throw new Error("One or more components provided to switchable element is not a valid component factory");if(!f.current||typeof f.current!="string"&&typeof f.current!="function")throw new Error("Missing or invalid 'current' property for switchable element: found '".concat(M(f.current),"' requires string or function"));var A=Object.keys(f.of);if(!A.includes(f.current))throw new Error("Component '".concat(f.current,"' not found in switchable element"));e.data.isSwitchable=!0}l[d]=e}return b.length>0&&b.map(function(g,_){return pn(g,t,i+1,_)}).forEach(function(g){Object.entries(g).forEach(function(_){var w=U(_,2),E=w[0],$=w[1];return l[E]=$})}),l}function dn(e,t,r){var n,o,i,a,s,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,c=arguments.length>4?arguments[4]:void 0;if(!!e){if((n=e.data)!==null&&n!==void 0&&n.componentsInjected)return e;u===0&&e.data&&(e.data.componentsInjected=!0);var p=e.sel||"NO SELECTOR",f=["collection","switchable","sygnal-factory"].concat(W(r)).includes(p)||typeof((o=e.data)===null||o===void 0||(i=o.props)===null||i===void 0?void 0:i.sygnalFactory)=="function",h=e==null||(a=e.data)===null||a===void 0?void 0:a.isCollection,b=e==null||(s=e.data)===null||s===void 0?void 0:s.isSwitchable;e.data&&e.data.props;var l=e.children||[];if(f){var d=hn(e,u,c),m=t[d];return h?(e.sel="div",e.children=Array.isArray(m)?m:[m],e):m}else return l.length>0&&(e.children=l.map(function(y,A){return dn(y,t,r,u+1,A)}).flat()),e}}var pr=new Map;function hn(e,t,r){var n=e.sel,o=typeof n=="string"?n:"functionComponent",i=pr.get(n);if(!i){var a=Date.now(),s=Math.floor(Math.random()*1e4);i="".concat(a,"-").concat(s),pr.set(n,i)}var u="".concat(i,"-").concat(t,"-").concat(r),c=e.data&&e.data.props||{},p=c.id&&JSON.stringify(c.id)||u,f="".concat(o,"::").concat(p);return f}function yn(e){return typeof e=="undefined"?e:I(I({},e),{},{children:Array.isArray(e.children)?e.children.map(yn):void 0,data:e.data&&I(I({},e.data),{},{componentsInjected:!1})})}function ka(){var e;return typeof window!="undefined"?e=window:typeof global!="undefined"?e=global:e=this,e.Cyclejs=e.Cyclejs||{},e=e.Cyclejs,e.adaptStream=e.adaptStream||function(t){return t},e}function xa(e){return ka().adaptStream(e)}function Ma(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=S.create());return t}function ja(e,t){var r={};for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n](t[n],n),r[n]&&typeof r[n]=="object"&&(r[n]._isCycleSource=n));return r}function La(e){for(var t in e)e.hasOwnProperty(t)&&e[t]&&typeof e[t].shamefullySendNext=="function"&&(e[t]=xa(e[t]));return e}function Fa(e,t){var r=an(),n=Object.keys(e).filter(function(s){return!!t[s]}),o={},i={};n.forEach(function(s){o[s]={_n:[],_e:[]},i[s]={next:function(u){return o[s]._n.push(u)},error:function(u){return o[s]._e.push(u)},complete:function(){}}});var a=n.map(function(s){return S.fromObservable(e[s]).subscribe(i[s])});return n.forEach(function(s){var u=t[s],c=function(f){r(function(){return u._n(f)})},p=function(f){r(function(){(console.error||console.log)(f),u._e(f)})};o[s]._n.forEach(c),o[s]._e.forEach(p),i[s].next=c,i[s].error=p,i[s]._n=c,i[s]._e=p}),o=null,function(){a.forEach(function(u){return u.unsubscribe()})}}function Ra(e){Object.keys(e).forEach(function(t){return e[t]._c()})}function Ba(e){for(var t in e)e.hasOwnProperty(t)&&e[t]&&e[t].dispose&&e[t].dispose()}function vn(e){return Object.keys(e).length===0}function Ua(e,t){if(typeof e!="function")throw new Error("First argument given to Cycle must be the 'main' function.");if(typeof t!="object"||t===null)throw new Error("Second argument given to Cycle must be an object with driver functions as properties.");if(vn(t))throw new Error("Second argument given to Cycle must be an object with at least one driver function declared as a property.");var r=Wa(t),n=e(r.sources);typeof window!="undefined"&&(window.Cyclejs=window.Cyclejs||{},window.Cyclejs.sinks=n);function o(){var i=r.run(n);return function(){i(),r.dispose()}}return{sinks:n,sources:r.sources,run:o}}function Wa(e){if(typeof e!="object"||e===null)throw new Error("Argument given to setupReusable must be an object with driver functions as properties.");if(vn(e))throw new Error("Argument given to setupReusable must be an object with at least one driver function declared as a property.");var t=Ma(e),r=ja(e,t),n=La(r);function o(a){return Fa(a,t)}function i(){Ba(n),Ra(t)}return{sources:n,run:o,dispose:i}}function qa(e,t){var r=Ua(e,t);return typeof window!="undefined"&&window.CyclejsDevTool_startGraphSerializer&&window.CyclejsDevTool_startGraphSerializer(r.sinks),r.run()}function Ga(e,t){return document.createElement(e,t)}function Ha(e,t,r){return document.createElementNS(e,t,r)}function za(){return document.createDocumentFragment()}function Ka(e){return document.createTextNode(e)}function Va(e){return document.createComment(e)}function Ja(e,t,r){e.insertBefore(t,r)}function Ya(e,t){e.removeChild(t)}function Xa(e,t){e.appendChild(t)}function Za(e){return e.parentNode}function Qa(e){return e.nextSibling}function ts(e){return e.tagName}function es(e,t){e.textContent=t}function rs(e){return e.textContent}function ns(e){return e.nodeType===1}function os(e){return e.nodeType===3}function is(e){return e.nodeType===8}function as(e){return e.nodeType===11}const mn={createElement:Ga,createElementNS:Ha,createTextNode:Ka,createDocumentFragment:za,createComment:Va,insertBefore:Ja,removeChild:Ya,appendChild:Xa,parentNode:Za,nextSibling:Qa,tagName:ts,setTextContent:es,getTextContent:rs,isElement:ns,isText:os,isComment:is,isDocumentFragment:as};function tt(e,t,r,n,o){const i=t===void 0?void 0:t.key;return{sel:e,data:t,children:r,text:n,elm:o,key:i}}const Ne=Array.isArray;function Jt(e){return typeof e=="string"||typeof e=="number"||e instanceof String||e instanceof Number}function ve(e){return e===void 0}function H(e){return e!==void 0}const me=tt("",{},[],void 0,void 0);function kt(e,t){var r,n;const o=e.key===t.key,i=((r=e.data)===null||r===void 0?void 0:r.is)===((n=t.data)===null||n===void 0?void 0:n.is);return e.sel===t.sel&&o&&i}function ss(){throw new Error("The document fragment is not supported on this platform.")}function us(e,t){return e.isElement(t)}function cs(e,t){return e.isDocumentFragment(t)}function fs(e,t,r){var n;const o={};for(let i=t;i<=r;++i){const a=(n=e[i])===null||n===void 0?void 0:n.key;a!==void 0&&(o[a]=i)}return o}const ls=["create","update","remove","destroy","pre","post"];function ps(e,t,r){const n={create:[],update:[],remove:[],destroy:[],pre:[],post:[]},o=t!==void 0?t:mn;for(const l of ls)for(const d of e){const m=d[l];m!==void 0&&n[l].push(m)}function i(l){const d=l.id?"#"+l.id:"",m=l.getAttribute("class"),y=m?"."+m.split(" ").join("."):"";return tt(o.tagName(l).toLowerCase()+d+y,{},[],void 0,l)}function a(l){return tt(void 0,{},[],void 0,l)}function s(l,d){return function(){if(--d===0){const y=o.parentNode(l);o.removeChild(y,l)}}}function u(l,d){var m,y,A,g;let _,w=l.data;if(w!==void 0){const O=(m=w.hook)===null||m===void 0?void 0:m.init;H(O)&&(O(l),w=l.data)}const E=l.children,$=l.sel;if($==="!")ve(l.text)&&(l.text=""),l.elm=o.createComment(l.text);else if($!==void 0){const O=$.indexOf("#"),N=$.indexOf(".",O),P=O>0?O:$.length,T=N>0?N:$.length,k=O!==-1||N!==-1?$.slice(0,Math.min(P,T)):$,j=l.elm=H(w)&&H(_=w.ns)?o.createElementNS(_,k,w):o.createElement(k,w);for(P<T&&j.setAttribute("id",$.slice(P+1,T)),N>0&&j.setAttribute("class",$.slice(T+1).replace(/\./g," ")),_=0;_<n.create.length;++_)n.create[_](me,l);if(Ne(E))for(_=0;_<E.length;++_){const nt=E[_];nt!=null&&o.appendChild(j,u(nt,d))}else Jt(l.text)&&o.appendChild(j,o.createTextNode(l.text));const rt=l.data.hook;H(rt)&&((y=rt.create)===null||y===void 0||y.call(rt,me,l),rt.insert&&d.push(l))}else if(((A=r==null?void 0:r.experimental)===null||A===void 0?void 0:A.fragments)&&l.children){const O=l.children;for(l.elm=((g=o.createDocumentFragment)!==null&&g!==void 0?g:ss)(),_=0;_<n.create.length;++_)n.create[_](me,l);for(_=0;_<O.length;++_){const N=O[_];N!=null&&o.appendChild(l.elm,u(N,d))}}else l.elm=o.createTextNode(l.text);return l.elm}function c(l,d,m,y,A,g){for(;y<=A;++y){const _=m[y];_!=null&&o.insertBefore(l,u(_,g),d)}}function p(l){var d,m;const y=l.data;if(y!==void 0){(m=(d=y==null?void 0:y.hook)===null||d===void 0?void 0:d.destroy)===null||m===void 0||m.call(d,l);for(let A=0;A<n.destroy.length;++A)n.destroy[A](l);if(l.children!==void 0)for(let A=0;A<l.children.length;++A){const g=l.children[A];g!=null&&typeof g!="string"&&p(g)}}}function f(l,d,m,y){for(var A,g;m<=y;++m){let _,w;const E=d[m];if(E!=null)if(H(E.sel)){p(E),_=n.remove.length+1,w=s(E.elm,_);for(let O=0;O<n.remove.length;++O)n.remove[O](E,w);const $=(g=(A=E==null?void 0:E.data)===null||A===void 0?void 0:A.hook)===null||g===void 0?void 0:g.remove;H($)?$(E,w):w()}else o.removeChild(l,E.elm)}}function h(l,d,m,y){let A=0,g=0,_=d.length-1,w=d[0],E=d[_],$=m.length-1,O=m[0],N=m[$],P,T,k,j;for(;A<=_&&g<=$;)w==null?w=d[++A]:E==null?E=d[--_]:O==null?O=m[++g]:N==null?N=m[--$]:kt(w,O)?(b(w,O,y),w=d[++A],O=m[++g]):kt(E,N)?(b(E,N,y),E=d[--_],N=m[--$]):kt(w,N)?(b(w,N,y),o.insertBefore(l,w.elm,o.nextSibling(E.elm)),w=d[++A],N=m[--$]):kt(E,O)?(b(E,O,y),o.insertBefore(l,E.elm,w.elm),E=d[--_],O=m[++g]):(P===void 0&&(P=fs(d,A,_)),T=P[O.key],ve(T)?o.insertBefore(l,u(O,y),w.elm):(k=d[T],k.sel!==O.sel?o.insertBefore(l,u(O,y),w.elm):(b(k,O,y),d[T]=void 0,o.insertBefore(l,k.elm,w.elm))),O=m[++g]);g<=$&&(j=m[$+1]==null?null:m[$+1].elm,c(l,j,m,g,$,y)),A<=_&&f(l,d,A,_)}function b(l,d,m){var y,A,g,_,w,E,$,O;const N=(y=d.data)===null||y===void 0?void 0:y.hook;(A=N==null?void 0:N.prepatch)===null||A===void 0||A.call(N,l,d);const P=d.elm=l.elm,T=l.children,k=d.children;if(l!==d){if(d.data!==void 0||H(d.text)&&d.text!==l.text){(g=d.data)!==null&&g!==void 0||(d.data={}),(_=l.data)!==null&&_!==void 0||(l.data={});for(let j=0;j<n.update.length;++j)n.update[j](l,d);($=(E=(w=d.data)===null||w===void 0?void 0:w.hook)===null||E===void 0?void 0:E.update)===null||$===void 0||$.call(E,l,d)}ve(d.text)?H(T)&&H(k)?T!==k&&h(P,T,k,m):H(k)?(H(l.text)&&o.setTextContent(P,""),c(P,null,k,0,k.length-1,m)):H(T)?f(P,T,0,T.length-1):H(l.text)&&o.setTextContent(P,""):l.text!==d.text&&(H(T)&&f(P,T,0,T.length-1),o.setTextContent(P,d.text)),(O=N==null?void 0:N.postpatch)===null||O===void 0||O.call(N,l,d)}}return function(d,m){let y,A,g;const _=[];for(y=0;y<n.pre.length;++y)n.pre[y]();for(us(o,d)?d=i(d):cs(o,d)&&(d=a(d)),kt(d,m)?b(d,m,_):(A=d.elm,g=o.parentNode(A),u(m,_),g!==null&&(o.insertBefore(g,m.elm,o.nextSibling(A)),f(g,[d],0,0))),y=0;y<_.length;++y)_[y].data.hook.insert(_[y]);for(y=0;y<n.post.length;++y)n.post[y]();return m}}function Fe(e,t,r){if(e.ns="http://www.w3.org/2000/svg",r!=="foreignObject"&&t!==void 0)for(let n=0;n<t.length;++n){const o=t[n];if(typeof o=="string")continue;const i=o.data;i!==void 0&&Fe(i,o.children,o.sel)}}function ut(e,t,r){let n={},o,i,a;if(r!==void 0?(t!==null&&(n=t),Ne(r)?o=r:Jt(r)?i=r.toString():r&&r.sel&&(o=[r])):t!=null&&(Ne(t)?o=t:Jt(t)?i=t.toString():t&&t.sel?o=[t]:n=t),o!==void 0)for(a=0;a<o.length;++a)Jt(o[a])&&(o[a]=tt(void 0,void 0,void 0,o[a],void 0));return e[0]==="s"&&e[1]==="v"&&e[2]==="g"&&(e.length===3||e[3]==="."||e[3]==="#")&&Fe(n,o,e),tt(e,n,o,i,void 0)}function Pe(e,t){const r=t!==void 0?t:mn;let n;if(r.isElement(e)){const o=e.id?"#"+e.id:"",i=e.getAttribute("class"),a=i?"."+i.split(" ").join("."):"",s=r.tagName(e).toLowerCase()+o+a,u={},c={},p={},f=[];let h,b,l;const d=e.attributes,m=e.childNodes;for(b=0,l=d.length;b<l;b++)h=d[b].nodeName,h[0]==="d"&&h[1]==="a"&&h[2]==="t"&&h[3]==="a"&&h[4]==="-"?c[h.slice(5)]=d[b].nodeValue||"":h!=="id"&&h!=="class"&&(u[h]=d[b].nodeValue);for(b=0,l=m.length;b<l;b++)f.push(Pe(m[b],t));return Object.keys(u).length>0&&(p.attrs=u),Object.keys(c).length>0&&(p.datasets=c),s[0]==="s"&&s[1]==="v"&&s[2]==="g"&&(s.length===3||s[3]==="."||s[3]==="#")&&Fe(p,f,s),tt(s,p,f,void 0,e)}else return r.isText(e)?(n=r.getTextContent(e),tt(void 0,void 0,void 0,n,e)):r.isComment(e)?(n=r.getTextContent(e),tt("!",{},[],n,e)):tt("",{},[],void 0,e)}const ds="http://www.w3.org/1999/xlink",hs="http://www.w3.org/XML/1998/namespace",dr=58,ys=120;function hr(e,t){let r;const n=t.elm;let o=e.data.attrs,i=t.data.attrs;if(!(!o&&!i)&&o!==i){o=o||{},i=i||{};for(r in i){const a=i[r];o[r]!==a&&(a===!0?n.setAttribute(r,""):a===!1?n.removeAttribute(r):r.charCodeAt(0)!==ys?n.setAttribute(r,a):r.charCodeAt(3)===dr?n.setAttributeNS(hs,r,a):r.charCodeAt(5)===dr?n.setAttributeNS(ds,r,a):n.setAttribute(r,a))}for(r in o)r in i||n.removeAttribute(r)}}const vs={create:hr,update:hr};function yr(e,t){let r,n;const o=t.elm;let i=e.data.class,a=t.data.class;if(!(!i&&!a)&&i!==a){i=i||{},a=a||{};for(n in i)i[n]&&!Object.prototype.hasOwnProperty.call(a,n)&&o.classList.remove(n);for(n in a)r=a[n],r!==i[n]&&o.classList[r?"add":"remove"](n)}}const ms={create:yr,update:yr},vr=/[A-Z]/g;function mr(e,t){const r=t.elm;let n=e.data.dataset,o=t.data.dataset,i;if(!n&&!o||n===o)return;n=n||{},o=o||{};const a=r.dataset;for(i in n)o[i]||(a?i in a&&delete a[i]:r.removeAttribute("data-"+i.replace(vr,"-$&").toLowerCase()));for(i in o)n[i]!==o[i]&&(a?a[i]=o[i]:r.setAttribute("data-"+i.replace(vr,"-$&").toLowerCase(),o[i]))}const gs={create:mr,update:mr};function gr(e,t){let r,n,o;const i=t.elm;let a=e.data.props,s=t.data.props;if(!(!a&&!s)&&a!==s){a=a||{},s=s||{};for(r in s)n=s[r],o=a[r],o!==n&&(r!=="value"||i[r]!==n)&&(i[r]=n)}}const bs={create:gr,update:gr},br=typeof window!="undefined"&&window.requestAnimationFrame.bind(window)||setTimeout,_s=function(e){br(function(){br(e)})};let Ce=!1;function ws(e,t,r){_s(function(){e[t]=r})}function _r(e,t){let r,n;const o=t.elm;let i=e.data.style,a=t.data.style;if(!i&&!a||i===a)return;i=i||{},a=a||{};const s="delayed"in i;for(n in i)a[n]||(n[0]==="-"&&n[1]==="-"?o.style.removeProperty(n):o.style[n]="");for(n in a)if(r=a[n],n==="delayed"&&a.delayed)for(const u in a.delayed)r=a.delayed[u],(!s||r!==i.delayed[u])&&ws(o.style,u,r);else n!=="remove"&&r!==i[n]&&(n[0]==="-"&&n[1]==="-"?o.style.setProperty(n,r):o.style[n]=r)}function Ss(e){let t,r;const n=e.elm,o=e.data.style;if(!(!o||!(t=o.destroy)))for(r in t)n.style[r]=t[r]}function Os(e,t){const r=e.data.style;if(!r||!r.remove){t();return}Ce||(e.elm.offsetLeft,Ce=!0);let n;const o=e.elm;let i=0;const a=r.remove;let s=0;const u=[];for(n in a)u.push(n),o.style[n]=a[n];const p=getComputedStyle(o)["transition-property"].split(", ");for(;i<p.length;++i)u.indexOf(p[i])!==-1&&s++;o.addEventListener("transitionend",function(f){f.target===o&&--s,s===0&&t()})}function As(){Ce=!1}const Es={pre:As,create:_r,update:_r,destroy:Ss,remove:Os};function re(e,t,r,n,o){r===void 0&&(r=!1),n===void 0&&(n=!1),o===void 0&&(o=!1);var i=null;return et.create({start:function(s){n?i=function(c){bn(c,n),s.next(c)}:i=function(c){s.next(c)},e.addEventListener(t,i,{capture:r,passive:o})},stop:function(){e.removeEventListener(t,i,r),i=null}})}function gn(e,t){for(var r=Object.keys(e),n=r.length,o=0;o<n;o++){var i=r[o];if(typeof e[i]=="object"&&typeof t[i]=="object"){if(!gn(e[i],t[i]))return!1}else if(e[i]!==t[i])return!1}return!0}function bn(e,t){if(t)if(typeof t=="boolean")e.preventDefault();else if($s(t))t(e)&&e.preventDefault();else if(typeof t=="object")gn(t,e)&&e.preventDefault();else throw new Error("preventDefault has to be either a boolean, predicate function or object")}function $s(e){return typeof e=="function"}var Ns=function(){function e(t){this._name=t}return e.prototype.select=function(t){return this},e.prototype.elements=function(){var t=z(S.of([document]));return t._isCycleSource=this._name,t},e.prototype.element=function(){var t=z(S.of(document));return t._isCycleSource=this._name,t},e.prototype.events=function(t,r,n){r===void 0&&(r={});var o;o=re(document,t,r.useCapture,r.preventDefault);var i=z(o);return i._isCycleSource=this._name,i},e}(),Ps=function(){function e(t){this._name=t}return e.prototype.select=function(t){return this},e.prototype.elements=function(){var t=z(S.of([document.body]));return t._isCycleSource=this._name,t},e.prototype.element=function(){var t=z(S.of(document.body));return t._isCycleSource=this._name,t},e.prototype.events=function(t,r,n){r===void 0&&(r={});var o;o=re(document.body,t,r.useCapture,r.preventDefault);var i=z(o);return i._isCycleSource=this._name,i},e}();function Cs(e){var t=1,r=11;return typeof HTMLElement=="object"?e instanceof HTMLElement||e instanceof DocumentFragment:e&&typeof e=="object"&&e!==null&&(e.nodeType===t||e.nodeType===r)&&typeof e.nodeName=="string"}function Is(e){return e.length>1&&(e[0]==="."||e[0]==="#")}function Ts(e){return e.nodeType===11}function Ds(e){if(typeof e!="string"&&!Cs(e))throw new Error("Given container is not a DOM element neither a selector string.")}function ks(e){var t=typeof e=="string"?document.querySelector(e):e;if(typeof e=="string"&&t===null)throw new Error("Cannot render into unknown element `"+e+"`");return t}function _n(e){for(var t="",r=e.length-1;r>=0&&e[r].type==="selector";r--)t=e[r].scope+" "+t;return t.trim()}function Re(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==t[r].type||e[r].scope!==t[r].scope)return!1;return!0}var wn=function(){function e(t,r){this.namespace=t,this.isolateModule=r,this._namespace=t.filter(function(n){return n.type!=="selector"})}return e.prototype.isDirectlyInScope=function(t){var r=this.isolateModule.getNamespace(t);if(!r||this._namespace.length>r.length||!Re(this._namespace,r.slice(0,this._namespace.length)))return!1;for(var n=this._namespace.length;n<r.length;n++)if(r[n].type==="total")return!1;return!0},e}();function xs(e){return Array.prototype.slice.call(e)}var Sn=function(){function e(t,r){this.namespace=t,this.isolateModule=r}return e.prototype.call=function(){var t=this.namespace,r=_n(t),n=new wn(t,this.isolateModule),o=this.isolateModule.getElement(t.filter(function(i){return i.type!=="selector"}));return o===void 0?[]:r===""?[o]:xs(o.querySelectorAll(r)).filter(n.isDirectlyInScope,n).concat(o.matches(r)?[o]:[])},e}(),Lt=globalThis&&globalThis.__assign||function(){return Lt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Lt.apply(this,arguments)};function Ms(e){return function(t,r){return r===":root"?t:t.map(function(n){if(!n)return n;var o=On(r),i=Lt({},n,{data:Lt({},n.data,{isolate:!n.data||!Array.isArray(n.data.isolate)?e.concat([o]):n.data.isolate})});return Lt({},i,{key:i.key!==void 0?i.key:JSON.stringify(i.data.isolate)})})}}function On(e){return{type:Is(e)?"sibling":"total",scope:e}}var js=function(){function e(t,r,n,o,i,a){n===void 0&&(n=[]),this._rootElement$=t,this._sanitation$=r,this._namespace=n,this._isolateModule=o,this._eventDelegator=i,this._name=a,this.isolateSource=function(s,u){return new e(s._rootElement$,s._sanitation$,s._namespace.concat(On(u)),s._isolateModule,s._eventDelegator,s._name)},this.isolateSink=Ms(this._namespace)}return e.prototype._elements=function(){if(this._namespace.length===0)return this._rootElement$.map(function(r){return[r]});var t=new Sn(this._namespace,this._isolateModule);return this._rootElement$.map(function(){return t.call()})},e.prototype.elements=function(){var t=z(this._elements().remember());return t._isCycleSource=this._name,t},e.prototype.element=function(){var t=z(this._elements().filter(function(r){return r.length>0}).map(function(r){return r[0]}).remember());return t._isCycleSource=this._name,t},Object.defineProperty(e.prototype,"namespace",{get:function(){return this._namespace},enumerable:!0,configurable:!0}),e.prototype.select=function(t){if(typeof t!="string")throw new Error("DOM driver's select() expects the argument to be a string as a CSS selector");if(t==="document")return new Ns(this._name);if(t==="body")return new Ps(this._name);var r=t===":root"?[]:this._namespace.concat({type:"selector",scope:t.trim()});return new e(this._rootElement$,this._sanitation$,r,this._isolateModule,this._eventDelegator,this._name)},e.prototype.events=function(t,r,n){if(r===void 0&&(r={}),typeof t!="string")throw new Error("DOM driver's events() expects argument to be a string representing the event type to listen for.");var o=this._eventDelegator.addEventListener(t,this._namespace,r,n),i=z(o);return i._isCycleSource=this._name,i},e.prototype.dispose=function(){this._sanitation$.shamefullySendNext(null)},e}(),Nt={},Ls=V&&V.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),o=0,t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n};Object.defineProperty(Nt,"__esModule",{value:!0});Nt.SampleCombineOperator=Nt.SampleCombineListener=void 0;var Fs=G,ct={},An=function(){function e(t,r){this.i=t,this.p=r,r.ils[t]=this}return e.prototype._n=function(t){var r=this.p;r.out!==ct&&r.up(t,this.i)},e.prototype._e=function(t){this.p._e(t)},e.prototype._c=function(){this.p.down(this.i,this)},e}();Nt.SampleCombineListener=An;var En=function(){function e(t,r){this.type="sampleCombine",this.ins=t,this.others=r,this.out=ct,this.ils=[],this.Nn=0,this.vals=[]}return e.prototype._start=function(t){this.out=t;for(var r=this.others,n=this.Nn=r.length,o=this.vals=new Array(n),i=0;i<n;i++)o[i]=ct,r[i]._add(new An(i,this));this.ins._add(this)},e.prototype._stop=function(){var t=this.others,r=t.length,n=this.ils;this.ins._remove(this);for(var o=0;o<r;o++)t[o]._remove(n[o]);this.out=ct,this.vals=[],this.ils=[]},e.prototype._n=function(t){var r=this.out;r!==ct&&(this.Nn>0||r._n(Ls([t],this.vals)))},e.prototype._e=function(t){var r=this.out;r!==ct&&r._e(t)},e.prototype._c=function(){var t=this.out;t!==ct&&t._c()},e.prototype.up=function(t,r){var n=this.vals[r];this.Nn>0&&n===ct&&this.Nn--,this.vals[r]=t},e.prototype.down=function(t,r){this.others[t]._remove(r)},e}();Nt.SampleCombineOperator=En;var $n;$n=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return function(o){return new Fs.Stream(new En(o,t))}};var Rs=Nt.default=$n;globalThis&&globalThis.__assign;function Nn(e){if(!e.sel)return{tagName:"",id:"",className:""};var t=e.sel,r=t.indexOf("#"),n=t.indexOf(".",r),o=r>0?r:t.length,i=n>0?n:t.length,a=r!==-1||n!==-1?t.slice(0,Math.min(o,i)):t,s=o<i?t.slice(o+1,i):void 0,u=n>0?t.slice(i+1).replace(/\./g," "):void 0;return{tagName:a,id:s,className:u}}function Bs(e){var t=Nn(e).className,r=t===void 0?"":t;if(!e.data)return r;var n=e.data,o=n.class,i=n.props;if(o){var a=Object.keys(o).filter(function(s){return o[s]});r+=" "+a.join(" ")}return i&&i.className&&(r+=" "+i.className),r&&r.trim()}var Mt;typeof self!="undefined"?Mt=self:typeof window!="undefined"?Mt=window:typeof global!="undefined"?Mt=global:Mt=Function("return this")();var wr=Mt.Symbol;typeof wr=="function"&&wr("parent");var Us=function(){function e(t){this.rootElement=t}return e.prototype.call=function(t){if(Ts(this.rootElement))return this.wrapDocFrag(t===null?[]:[t]);if(t===null)return this.wrap([]);var r=Nn(t),n=r.tagName,o=r.id,i=Bs(t),a=t.data||{},s=a.props||{},u=s.id,c=u===void 0?o:u,p=typeof c=="string"&&c.toUpperCase()===this.rootElement.id.toUpperCase()&&n.toUpperCase()===this.rootElement.tagName.toUpperCase()&&i.toUpperCase()===this.rootElement.className.toUpperCase();return p?t:this.wrap([t])},e.prototype.wrapDocFrag=function(t){return tt("",{isolate:[]},t,void 0,this.rootElement)},e.prototype.wrap=function(t){var r=this.rootElement,n=r.tagName,o=r.id,i=r.className,a=o?"#"+o:"",s=i?"."+i.split(" ").join("."):"",u=ut(""+n.toLowerCase()+a+s,{},t);return u.data=u.data||{},u.data.isolate=u.data.isolate||[],u},e}(),Ws=[Es,ms,bs,vs,gs],Pn=function(){function e(t){this.mapper=t,this.tree=[void 0,{}]}return e.prototype.set=function(t,r,n){for(var o=this.tree,i=n!==void 0?n:t.length,a=0;a<i;a++){var s=this.mapper(t[a]),u=o[1][s];u||(u=[void 0,{}],o[1][s]=u),o=u}o[0]=r},e.prototype.getDefault=function(t,r,n){return this.get(t,r,n)},e.prototype.get=function(t,r,n){for(var o=this.tree,i=n!==void 0?n:t.length,a=0;a<i;a++){var s=this.mapper(t[a]),u=o[1][s];if(!u)if(r)u=[void 0,{}],o[1][s]=u;else return;o=u}return r&&!o[0]&&(o[0]=r()),o[0]},e.prototype.delete=function(t){for(var r=this.tree,n=0;n<t.length-1;n++){var o=r[1][this.mapper(t[n])];if(!o)return;r=o}delete r[1][this.mapper(t[t.length-1])]},e}(),qs=function(){function e(){this.namespaceTree=new Pn(function(t){return t.scope}),this.namespaceByElement=new Map,this.vnodesBeingRemoved=[]}return e.prototype.setEventDelegator=function(t){this.eventDelegator=t},e.prototype.insertElement=function(t,r){this.namespaceByElement.set(r,t),this.namespaceTree.set(t,r)},e.prototype.removeElement=function(t){this.namespaceByElement.delete(t);var r=this.getNamespace(t);r&&this.namespaceTree.delete(r)},e.prototype.getElement=function(t,r){return this.namespaceTree.get(t,void 0,r)},e.prototype.getRootElement=function(t){if(this.namespaceByElement.has(t))return t;for(var r=t;!this.namespaceByElement.has(r);)if(r=r.parentNode,r){if(r.tagName==="HTML")throw new Error("No root element found, this should not happen at all")}else return;return r},e.prototype.getNamespace=function(t){var r=this.getRootElement(t);if(!!r)return this.namespaceByElement.get(r)},e.prototype.createModule=function(){var t=this;return{create:function(r,n){var o=n.elm,i=n.data,a=i===void 0?{}:i,s=a.isolate;Array.isArray(s)&&t.insertElement(s,o)},update:function(r,n){var o=r.elm,i=r.data,a=i===void 0?{}:i,s=n.elm,u=n.data,c=u===void 0?{}:u,p=a.isolate,f=c.isolate;Re(p,f)||Array.isArray(p)&&t.removeElement(o),Array.isArray(f)&&t.insertElement(f,s)},destroy:function(r){t.vnodesBeingRemoved.push(r)},remove:function(r,n){t.vnodesBeingRemoved.push(r),n()},post:function(){for(var r=t.vnodesBeingRemoved,n=r.length-1;n>=0;n--){var o=r[n],i=o.data!==void 0?o.data.isolation:void 0;i!==void 0&&t.removeElement(i),t.eventDelegator.removeElement(o.elm,i)}t.vnodesBeingRemoved=[]}}},e}(),Gs=function(){function e(){this.arr=[],this.prios=[]}return e.prototype.add=function(t,r){for(var n=0;n<this.arr.length;n++)if(this.prios[n]<r){this.arr.splice(n,0,t),this.prios.splice(n,0,r);return}this.arr.push(t),this.prios.push(r)},e.prototype.forEach=function(t){for(var r=0;r<this.arr.length;r++)t(this.arr[r],r,this.arr)},e.prototype.delete=function(t){for(var r=0;r<this.arr.length;r++)if(this.arr[r]===t){this.arr.splice(r,1),this.prios.splice(r,1);return}},e}(),ne=globalThis&&globalThis.__assign||function(){return ne=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ne.apply(this,arguments)},Hs=["blur","canplay","canplaythrough","durationchange","emptied","ended","focus","load","loadeddata","loadedmetadata","mouseenter","mouseleave","pause","play","playing","ratechange","reset","scroll","seeked","seeking","stalled","submit","suspend","timeupdate","unload","volumechange","waiting"],zs=function(){function e(t,r){var n=this;this.rootElement$=t,this.isolateModule=r,this.virtualListeners=new Pn(function(o){return o.scope}),this.nonBubblingListenersToAdd=new Set,this.virtualNonBubblingListener=[],this.isolateModule.setEventDelegator(this),this.domListeners=new Map,this.domListenersToAdd=new Map,this.nonBubblingListeners=new Map,t.addListener({next:function(o){n.origin!==o&&(n.origin=o,n.resetEventListeners(),n.domListenersToAdd.forEach(function(i,a){return n.setupDOMListener(a,i)}),n.domListenersToAdd.clear()),n.nonBubblingListenersToAdd.forEach(function(i){n.setupNonBubblingListener(i)})}})}return e.prototype.addEventListener=function(t,r,n,o){var i=S.never(),a,s=new wn(r,this.isolateModule),u=o===void 0?Hs.indexOf(t)===-1:o;if(u)return this.domListeners.has(t)||this.setupDOMListener(t,!!n.passive),a=this.insertListener(i,s,t,n),i;var c=[];this.nonBubblingListenersToAdd.forEach(function(w){return c.push(w)});for(var p=void 0,f=0,h=c.length,b=function(w){w[0];var E=w[1],$=w[2];return w[3],t===E&&Re($.namespace,r)};!p&&f<h;){var l=c[f];p=b(l)?l:p,f++}var d=p,m;if(d){var A=d[0];m=A}else{var y=new Sn(r,this.isolateModule);a=this.insertListener(i,s,t,n),d=[i,t,y,a],m=i,this.nonBubblingListenersToAdd.add(d),this.setupNonBubblingListener(d)}var g=this,_=null;return S.create({start:function(w){_=m.subscribe(w)},stop:function(){d[0];var w=d[1],E=d[2];d[3];var $=E.call();$.forEach(function(O){var N=O.subs;N&&N[w]&&(N[w].unsubscribe(),delete N[w])}),g.nonBubblingListenersToAdd.delete(d),_.unsubscribe()}})},e.prototype.removeElement=function(t,r){r!==void 0&&this.virtualListeners.delete(r);var n=[];this.nonBubblingListeners.forEach(function(a,s){if(a.has(t)){n.push([s,t]);var u=t.subs;u&&Object.keys(u).forEach(function(c){u[c].unsubscribe()})}});for(var o=0;o<n.length;o++){var i=this.nonBubblingListeners.get(n[o][0]);!i||(i.delete(n[o][1]),i.size===0?this.nonBubblingListeners.delete(n[o][0]):this.nonBubblingListeners.set(n[o][0],i))}},e.prototype.insertListener=function(t,r,n,o){var i=[],a=r._namespace,s=a.length;do i.push(this.getVirtualListeners(n,a,!0,s)),s--;while(s>=0&&a[s].type!=="total");for(var u=ne({},o,{scopeChecker:r,subject:t,bubbles:!!o.bubbles,useCapture:!!o.useCapture,passive:!!o.passive}),c=0;c<i.length;c++)i[c].add(u,a.length);return u},e.prototype.getVirtualListeners=function(t,r,n,o){n===void 0&&(n=!1);var i=o!==void 0?o:r.length;if(!n)for(var a=i-1;a>=0;a--){if(r[a].type==="total"){i=a+1;break}i=a}var s=this.virtualListeners.getDefault(r,function(){return new Map},i);return s.has(t)||s.set(t,new Gs),s.get(t)},e.prototype.setupDOMListener=function(t,r){var n=this;if(this.origin){var o=re(this.origin,t,!1,!1,r).subscribe({next:function(i){return n.onEvent(t,i,r)},error:function(){},complete:function(){}});this.domListeners.set(t,{sub:o,passive:r})}else this.domListenersToAdd.set(t,r)},e.prototype.setupNonBubblingListener=function(t){t[0];var r=t[1],n=t[2],o=t[3];if(!!this.origin){var i=n.call();if(i.length){var a=this;i.forEach(function(s){var u,c=s.subs;if(!c||!c[r]){var p=re(s,r,!1,!1,o.passive).subscribe({next:function(h){return a.onEvent(r,h,!!o.passive,!1)},error:function(){},complete:function(){}});a.nonBubblingListeners.has(r)||a.nonBubblingListeners.set(r,new Map);var f=a.nonBubblingListeners.get(r);if(!f)return;f.set(s,{sub:p,destination:o}),s.subs=ne({},c,(u={},u[r]=p,u))}})}}},e.prototype.resetEventListeners=function(){for(var t=this.domListeners.entries(),r=t.next();!r.done;){var n=r.value,o=n[0],i=n[1],a=i.sub,s=i.passive;a.unsubscribe(),this.setupDOMListener(o,s),r=t.next()}},e.prototype.putNonBubblingListener=function(t,r,n,o){var i=this.nonBubblingListeners.get(t);if(!!i){var a=i.get(r);a&&a.destination.passive===o&&a.destination.useCapture===n&&(this.virtualNonBubblingListener[0]=a.destination)}},e.prototype.onEvent=function(t,r,n,o){o===void 0&&(o=!0);var i=this.patchEvent(r),a=this.isolateModule.getRootElement(r.target);if(o){var s=this.isolateModule.getNamespace(r.target);if(!s)return;var u=this.getVirtualListeners(t,s);this.bubble(t,r.target,a,i,u,s,s.length-1,!0,n),this.bubble(t,r.target,a,i,u,s,s.length-1,!1,n)}else this.putNonBubblingListener(t,r.target,!0,n),this.doBubbleStep(t,r.target,a,i,this.virtualNonBubblingListener,!0,n),this.putNonBubblingListener(t,r.target,!1,n),this.doBubbleStep(t,r.target,a,i,this.virtualNonBubblingListener,!1,n),r.stopPropagation()},e.prototype.bubble=function(t,r,n,o,i,a,s,u,c){!u&&!o.propagationHasBeenStopped&&this.doBubbleStep(t,r,n,o,i,u,c);var p=n,f=s;if(r===n)if(s>=0&&a[s].type==="sibling")p=this.isolateModule.getElement(a,s),f--;else return;r.parentNode&&p&&this.bubble(t,r.parentNode,p,o,i,a,f,u,c),u&&!o.propagationHasBeenStopped&&this.doBubbleStep(t,r,n,o,i,u,c)},e.prototype.doBubbleStep=function(t,r,n,o,i,a,s){!n||(this.mutateEventCurrentTarget(o,r),i.forEach(function(u){if(u.passive===s&&u.useCapture===a){var c=_n(u.scopeChecker.namespace);!o.propagationHasBeenStopped&&u.scopeChecker.isDirectlyInScope(r)&&(c!==""&&r.matches(c)||c===""&&r===n)&&(bn(o,u.preventDefault),u.subject.shamefullySendNext(o))}}))},e.prototype.patchEvent=function(t){var r=t;r.propagationHasBeenStopped=!1;var n=r.stopPropagation;return r.stopPropagation=function(){n.call(this),this.propagationHasBeenStopped=!0},r},e.prototype.mutateEventCurrentTarget=function(t,r){try{Object.defineProperty(t,"currentTarget",{value:r,configurable:!0})}catch{console.log("please use event.ownerTarget")}t.ownerTarget=r},e}();function Ks(e){if(!Array.isArray(e))throw new Error("Optional modules option must be an array for snabbdom modules")}function Vs(e){if(!e||typeof e.addListener!="function"||typeof e.fold!="function")throw new Error("The DOM driver function expects as input a Stream of virtual DOM elements")}function Js(e){return S.merge(e,S.never())}function Ys(e){return e.elm}function Xs(e){(console.error||console.log)(e)}function Zs(){return S.create({start:function(e){document.readyState==="loading"?document.addEventListener("readystatechange",function(){var t=document.readyState;(t==="interactive"||t==="complete")&&(e.next(null),e.complete())}):(e.next(null),e.complete())},stop:function(){}})}function Qs(e){return e.data=e.data||{},e.data.isolate=[],e}function tu(e,t){t===void 0&&(t={}),Ds(e);var r=t.modules||Ws;Ks(r);var n=new qs,o=t&&t.snabbdomOptions||void 0,i=ps([n.createModule()].concat(r),void 0,o),a=Zs(),s,u,c=S.create({start:function(f){u=new MutationObserver(function(){return f.next(null)})},stop:function(){u.disconnect()}});function p(f,h){h===void 0&&(h="DOM"),Vs(f);var b=S.create(),l=a.map(function(){var g=ks(e)||document.body;return s=new Us(g),g}),d=f.remember();d.addListener({}),c.addListener({});var m=l.map(function(g){return S.merge(d.endWhen(b),b).map(function(_){return s.call(_)}).startWith(Qs(Pe(g))).fold(i,Pe(g)).drop(1).map(Ys).startWith(g).map(function(_){return u.observe(_,{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0}),_}).compose(Js)}).flatten(),y=ee(a,c).endWhen(b).compose(Rs(m)).map(function(g){return g[1]}).remember();y.addListener({error:t.reportSnabbdomError||Xs});var A=new zs(y,n);return new js(y,b,[],n,A,h)}return p}function eu(e){return typeof e=="string"&&e.length>0}function ru(e){return eu(e)&&(e[0]==="."||e[0]==="#")}function Cn(e){return function(r,n,o){var i=typeof r!="undefined",a=typeof n!="undefined",s=typeof o!="undefined";return ru(r)?a&&s?ut(e+r,n,o):a?ut(e+r,n):ut(e+r,{}):s?ut(e+r,n,o):a?ut(e,r,n):i?ut(e,r):ut(e,{})}}var nu=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","colorProfile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotlight","feTile","feTurbulence","filter","font","fontFace","fontFaceFormat","fontFaceName","fontFaceSrc","fontFaceUri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missingGlyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],ou=Cn("svg");nu.forEach(function(e){ou[e]=Cn(e)});var iu=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","dd","del","details","dfn","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","meta","nav","noscript","object","ol","optgroup","option","p","param","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","u","ul","video"];iu.forEach(function(e){});function au(e){var t=new EventTarget;return e.subscribe({next:function(n){return t.dispatchEvent(new CustomEvent("data",{detail:n}))}}),{select:function(n){var o=!n,i=Array.isArray(n)?n:[n],a,s=S.create({start:function(c){a=function(f){var h=f.detail,b=h&&h.data||null;(o||i.includes(h.type))&&c.next(b)},t.addEventListener("data",a)},stop:function(c){return t.removeEventListener("data",a)}});return z(s)}}}function su(e){e.addListener({next:function(r){console.log(r)}})}function Sr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Or(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Sr(Object(r),!0).forEach(function(n){uu(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sr(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uu(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cu(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=r.mountPoint,o=n===void 0?"#root":n,i=r.fragments,a=i===void 0?!0:i,s=Xi(e,"STATE"),u={EVENTS:au,DOM:tu(o,{snabbdomOptions:{experimental:{fragments:a}}}),LOG:su},c=Or(Or({},u),t);return qa(s,c)}function Ar(e,t){return pu(e)||lu(e,t)||In(e,t)||fu()}function fu(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lu(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(u){i=!0,s=u}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function pu(e){if(Array.isArray(e))return e}function Ie(e){return Ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ie(e)}function ge(e){return yu(e)||hu(e)||In(e)||du()}function du(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function In(e,t){if(!!e){if(typeof e=="string")return Te(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Te(e,t)}}function hu(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yu(e){if(Array.isArray(e))return Te(e)}function Te(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vu(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce(function(n,o){return typeof o=="string"&&!n.includes(o)?n.push.apply(n,ge(Dn(o))):Array.isArray(o)?n.push.apply(n,ge(mu(o))):Ie(o)==="object"&&n.push.apply(n,ge(gu(o))),n},[]).join(" ")}function Tn(e){return/^[a-zA-Z0-9-_]+$/.test(e)}function Dn(e){if(typeof e!="string")throw new Error("Class name must be a string");return e.trim().split(" ").reduce(function(t,r){if(r.trim().length===0)return t;if(!Tn(r))throw new Error("".concat(r," is not a valid CSS class name"));return t.push(r),t},[])}function mu(e){return e.map(Dn).flat()}function gu(e){var t=Object.entries(e).filter(function(r){var n=Ar(r,2);n[0];var o=n[1];return typeof o=="function"?o():!!o}).map(function(r){var n=Ar(r,2),o=n[0];n[1];var i=o.trim();if(!Tn(i))throw new Error("".concat(i," is not a valid CSS class name"));return i});return t}var kn={};Object.defineProperty(kn,"__esModule",{value:!0});var bu=G,_u=function(){function e(t,r){this.dt=t,this.ins=r,this.type="throttle",this.out=null,this.id=null}return e.prototype._start=function(t){this.out=t,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=null,this.id=null},e.prototype.clearInterval=function(){var t=this.id;t!==null&&clearInterval(t),this.id=null},e.prototype._n=function(t){var r=this,n=this.out;!n||this.id||(n._n(t),this.id=setInterval(function(){r.clearInterval()},this.dt))},e.prototype._e=function(t){var r=this.out;!r||(this.clearInterval(),r._e(t))},e.prototype._c=function(){var t=this.out;!t||(this.clearInterval(),t._c())},e}();function wu(e){return function(r){return new bu.Stream(new _u(e,r))}}kn.default=wu;function De(e){return De=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},De(e)}var Su=function(t){return t===void 0},Ou=function(t){return typeof t=="number"},Au=function(t){return typeof t=="string"},xn=function(t){return Au(t)||Ou(t)},Eu=function(t){return Array.isArray(t)},$u=function(t){return De(t)==="object"&&t!==null},Nu=function(t){return typeof t=="function"},Pu=function(t){return $u(t)&&"sel"in t&&"data"in t&&"children"in t&&"text"in t},Cu={svg:1,circle:1,ellipse:1,line:1,polygon:1,polyline:1,rect:1,g:1,path:1,text:1},Iu=function(t){return t.sel in Cu},Yt=Object.prototype.hasOwnProperty,Mn=Object.prototype.toString,Er=Object.defineProperty,$r=Object.getOwnPropertyDescriptor,Nr=function(t){return typeof Array.isArray=="function"?Array.isArray(t):Mn.call(t)==="[object Array]"},Pr=function(t){if(!t||Mn.call(t)!=="[object Object]")return!1;var r=Yt.call(t,"constructor"),n=t.constructor&&t.constructor.prototype&&Yt.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!r&&!n)return!1;var o;for(o in t);return typeof o=="undefined"||Yt.call(t,o)},Cr=function(t,r){Er&&r.name==="__proto__"?Er(t,r.name,{enumerable:!0,configurable:!0,value:r.newValue,writable:!0}):t[r.name]=r.newValue},Ir=function(t,r){if(r==="__proto__")if(Yt.call(t,r)){if($r)return $r(t,r).value}else return;return t[r]},jn=function e(){var t,r,n,o,i,a,s=arguments[0],u=1,c=arguments.length,p=!1;for(typeof s=="boolean"&&(p=s,s=arguments[1]||{},u=2),(s==null||typeof s!="object"&&typeof s!="function")&&(s={});u<c;++u)if(t=arguments[u],t!=null)for(r in t)n=Ir(s,r),o=Ir(t,r),s!==o&&(p&&o&&(Pr(o)||(i=Nr(o)))?(i?(i=!1,a=n&&Nr(n)?n:[]):a=n&&Pr(n)?n:{},Cr(s,{name:r,newValue:e(p,a,o)})):typeof o!="undefined"&&Cr(s,{name:r,newValue:o}));return s};function Xt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ke=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return jn.apply(void 0,[!0].concat(r))},Tu=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return jn.apply(void 0,[!1].concat(r))},Du=function e(t,r,n){for(var o=n,i=0;i<t.length;i++){var a=t[i];Eu(a)?o=e(a,r,o):o=r(o,a)}return o},Be=function(t,r){return Object.keys(t).map(function(n){return r(n,t[n])}).reduce(function(n,o){return ke(n,o)},{})},ku=function(t,r){return Be(t,function(n,o){var i=n.indexOf("-");if(i>-1&&r[n.slice(0,i)]!==void 0){var a=Xt({},n.slice(i+1),o);return Xt({},n.slice(0,i),a)}return Xt({},n,o)})},Tr=function(t,r){return Be(r,function(n,o){return n!==t?Xt({},n,o):{}})};function zt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var xu=function(t){return xn(t)?{text:t,sel:void 0,data:void 0,children:void 0,elm:void 0,key:void 0}:void 0},Ln=function e(t){return Iu(t)?Tu(t,{data:Tr("props",ke(t.data,{ns:"http://www.w3.org/2000/svg",attrs:Tr("className",ke(t.data.props,{class:t.data.props?t.data.props.className:void 0}))}))},{children:Su(t.children)?void 0:t.children.map(function(r){return e(r)})}):t},dt={for:"attrs",role:"attrs",tabindex:"attrs","aria-*":"attrs",key:null},Mu=function(t,r){return Be(t,function(n,o){var i=zt({},n,o);if(dt[n]&&r[dt[n]]!==void 0)return zt({},dt[n],i);if(dt[n]===null)return{};for(var a=Object.keys(dt),s=0;s<a.length;s++){var u=a[s];if(u.charAt(u.length-1)==="*"&&n.indexOf(u.slice(0,-1))===0&&r[dt[u]]!==void 0)return zt({},dt[u],i)}return r[n]!==void 0?zt({},r[n]?r[n]:n,o):r.props!==void 0?{props:i}:i})},ju=function(t,r){return Ln(Mu(ku(t,r),r))},Lu=function(t){return t.length>1||!xn(t[0])?void 0:t[0].toString()},Fu=function(t){return Du(t,function(r,n){var o=Pu(n)?n:xu(n);return r.push(o),r},[])},Ru={attrs:"",props:"",class:"",data:"dataset",style:"",hook:"",on:""},Bu=function(t){return function(r,n){typeof r=="undefined"&&(r="UNDEFINED",cnosole.error("JSX Error: Capitalized HTML element without corresponding Sygnal factory.  Components with names where the first letter is capital MUST be defined or included at the parent component's file scope."));for(var o=arguments.length,i=new Array(o>2?o-2:0),a=2;a<o;a++)i[a-2]=arguments[a];if(Nu(r)){if(r.name==="Fragment")return r(n||{},i);var s=r;r=r.name||"sygnal-factory",n||(n={}),n.sygnalFactory=s}var u=Lu(i);return Ln({sel:r,data:n?ju(n,t):{},children:typeof u!="undefined"?void 0:Fu(i),text:u,elm:void 0,key:n?n.key:void 0})}},D=Bu(Ru);const Uu={0:"1111110",1:"0110000",2:"1101101",3:"1111001",4:"0110011",5:"1011011",6:"1011111",7:"1110000",8:"1111111",9:"1111011","-":"0000001",".":"0000000"};var Dr=ln({name:"DIGIT",calculated:{segments:e=>Uu[e.digit].split("").map(t=>t==="1")},view:({state:e})=>{let{digit:t,segments:r,fill:n,background:o,padding:i,skew:a,transition:s,id:u}=e;if(i||(i="0.1em"),o||(o="transparent"),t===".")return D("span",{style:{fontSize:`calc(1em + ${i} * 2)`,color:n}},".");const c=f=>vu("segment",`segment-${f}`,{on:r[f]}),p={fill:n,transition:s};return D("div",{className:"digit",style:{height:"1em",backgroundColor:o,padding:i,transform:`skew(${a||"0"})`},id:u},D("svg",{style:{height:"1em"},xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 292.06 585.99"},D("defs",null,D("style",null,`
              .segment {opacity: 0.1;}
              .segment.on {opacity: 1;}
            `)),D("polygon",{style:p,className:c(0),points:"230.47 58.07 61.27 58.23 61.27 58.07 32.39 29.04 61.27 0.15 230.47 0 259.36 29.04 230.47 57.92 230.47 58.07"}),D("polygon",{style:p,className:c(1),points:"292.06 61.95 292.06 259.88 291.9 259.88 262.87 288.76 233.98 259.88 233.98 61.95 263.02 33.07 291.9 61.95 292.06 61.95"}),D("polygon",{style:p,className:c(2),points:"292.06 325.72 292.06 523.65 291.9 523.65 262.87 552.52 233.98 523.65 233.98 325.72 263.02 296.83 291.9 325.72 292.06 325.72"}),D("polygon",{style:p,className:c(3),points:"230.47 585.84 61.27 585.99 61.27 585.84 32.39 556.8 61.27 527.92 230.47 527.76 259.36 556.8 230.47 585.68 230.47 585.84"}),D("polygon",{style:p,className:c(4),points:"58.07 325.72 58.07 523.65 57.92 523.65 28.89 552.52 0 523.65 0 325.72 29.04 296.83 57.92 325.72 58.07 325.72"}),D("polygon",{style:p,className:c(5),points:"58.07 61.95 58.07 259.88 57.92 259.88 28.89 288.76 0 259.88 0 61.95 29.04 33.07 57.92 61.95 58.07 61.95"}),D("polygon",{style:p,className:c(6),points:"230.47 321.75 61.27 321.9 61.27 321.75 32.39 292.72 61.27 263.83 230.47 263.68 259.36 292.72 230.47 321.59 230.47 321.75"})))}});const kr={"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,x:(e,t)=>e*t},xr=["1","2","3","4","5","6","7","8","9","0"],Mr=["/","x","-","+"],Wu="AC",qu="+/-",jr="%",Lr=".",Fr="=",ht="num",be="op",yt="eq",Rr="-7deg",Br="100ms",Gu="#AAA",Hu="#999";var zu=ln({name:"CALCULATOR",initialState:{display:"",register:"",mode:ht,operation:null},calculated:{displayFloat:e=>{const t=parseFloat(e.display);return isNaN(t)?"":t},registerFloat:e=>{const t=parseFloat(e.register);return isNaN(t)?"":t},displayDigits:e=>{const t=Gu,r=Rr,n=Br;return e.display.split("").slice(0,10).map((o,i)=>({digit:o,fill:t,skew:r,transition:n,id:"disp"+(10-e.display.length+i)}))},registerDigits:e=>{const t=Hu,r=Rr,n=Br;return e.mode===yt?[]:e.register.split("").slice(0,10).map((o,i)=>({digit:o,fill:t,skew:r,transition:n,id:"reg"+(10-e.register.length+i)}))}},model:{NUMBER_INPUT:(e,t)=>{if(t==="0"&&e.display==="0")return At;const r=e.mode===ht?e.display:"",n=e.mode!==yt?e.register:"",o=e.mode!==yt?e.operation:"",i=r+t;return Q(Z({},e),{display:i,register:n,operation:o,mode:ht})},ADD_DECIMAL:(e,t)=>{if(e.mode===yt)return Q(Z({},e),{display:"0.",register:"",operation:null,mode:ht});if(e.display.includes("."))return At;if(e.display==="")return Q(Z({},e),{mode:ht,display:"0."});const r=e.display+".";return Q(Z({},e),{display:r})},RUN_CALC:e=>{if(!e.operation||e.display==="")return At;let t,r,n;e.mode===yt?(t=e.register,r=e.displayFloat,n=e.registerFloat):(t=e.display,r=e.registerFloat,n=e.displayFloat);const o=kr[e.operation](r,n).toString();return Q(Z({},e),{display:o,register:t,mode:yt})},SET_OPERATOR:(e,t)=>{if(e.mode!==be&&e.display==="")return At;const n=e.mode==ht&&e.operation?kr[e.operation](e.registerFloat,e.displayFloat).toString():e.display;if(e.mode===be&&e.display==="")return Q(Z({},e),{operation:t});const o="";return Q(Z({},e),{display:o,register:n,mode:be,operation:t})},CLEAR_ALL:(e,t)=>({display:"",register:"",mode:ht,operation:null}),SWITCH_SIGN:(e,t)=>Q(Z({},e),{display:e.display[0]==="-"?e.display.slice(1):"-"+e.display}),MAKE_PERCENT:(e,t)=>Q(Z({},e),{display:(e.displayFloat/100).toString()})},intent:({DOM:e})=>{const t=h=>b=>b.target.dataset[h],r=h=>e.select(h).events("click").map(t("value")),n=e.select("document").events("keydown").map(h=>h.key),o=h=>b=>h.includes(b),i=n.filter(o(xr)),a=n.filter(o([Lr])),s=n.filter(o([Fr,"Enter"])),u=n.filter(o([...Mr,"*"])).map(h=>h==="*"?"x":h),c=n.filter(o(["Backspace"])),p=n.filter(o(["~"])),f=n.filter(o([jr]));return{NUMBER_INPUT:S.merge(r(".number"),i),ADD_DECIMAL:S.merge(r(".decimal"),a),RUN_CALC:S.merge(r(".equal"),s),SET_OPERATOR:S.merge(r(".operator"),u),CLEAR_ALL:S.merge(r(".clear"),c),SWITCH_SIGN:S.merge(r(".sign"),p),MAKE_PERCENT:S.merge(r(".percent"),f)}},view:({state:e})=>{const{operation:t,mode:r}=e,n=xr.map(a=>D("div",{className:"button number","data-value":`${a}`},a)),o=Mr.map(a=>D("div",{className:"button operator","data-value":a},a));return D("div",{className:"calculator"},D("div",{className:"display"},D("div",{className:"previous"},D("collection",{of:Dr,for:"registerDigits",className:"register-container"}),D("span",{className:"operation"},r===yt?"":t)),D("collection",{of:Dr,for:"displayDigits",className:"current-container"})),D("div",{className:"keypad"},D("div",{className:"numbers"},D("div",{className:"button clear"},Wu),D("div",{className:"button sign"},qu),D("div",{className:"button percent"},jr),n,D("div",{className:"button decimal"},Lr)),D("div",{className:"operators"},o,D("div",{className:"button equal"},Fr))))}});cu(zu);
